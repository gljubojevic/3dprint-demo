{"version":3,"sources":["theme.js","ui/AppTools.js","ui/DrawerMenu.js","ui/AnimSelector.js","ui/MainSelector.js","ui/CategorySelector.js","editor/View3D.js","App.js","reportWebVitals.js","index.js"],"names":["theme","createTheme","AppTools","AppBar","position","Toolbar","variant","IconButton","edge","color","onClick","this","props","toggleDrawer","Typography","Component","defaultProps","DrawerMenu","bind","save","state","isOpen","e","type","key","setState","fileFormat","currentTarget","dataset","value","console","error","Drawer","anchor","open","onClose","Box","p","component","Divider","List","ListItem","ListItemButton","ListItemIcon","ListItemText","primary","AnimSelector","animFrameLabel","radioChange","sliderChange","v","target","o","findSelected","animPoses","setAnimTime","frameTime","opts","i","length","enabled","frames","lbl","Math","round","Paper","sx","m","opacity","FormControl","width","FormLabel","Slider","defaultValue","getAriaValueText","valueLabelDisplay","marks","min","max","step","onChange","toggleAnim","val","name","RadioGroup","renderRadios","map","idx","FormControlLabel","label","control","Radio","Fragment","renderRadioSelect","renderAnimFrames","MainSelector","menuSelected","elementCategorySelected","selectedOption","menu","selectElementCategory","c","selected","elementCategory","elementGroups","g","category","disablePadding","toUpperCase","ListSubheader","renderCategoryOptions","optAnimations","toggleAnimation","setAnimationTime","showDone","showOptions","zIndex","top","mixins","toolbar","minHeight","bgcolor","borderRadius","renderDone","renderOptions","renderCategorySelector","renderAnimSelector","toggleElement","CategorySelector","checkChange","groups","n","checked","visible","items","Checkbox","style","margin","padding","description","src","thumbnail","alt","dispName","endsWith","singleSelect","renderCheckboxes","findCategory","right","renderCategory","View3D","refRenderer","React","createRef","animate","loadObjectDirect","loaderOk","loaderAnimOk","loaderError","loaderProgress","onWindowResize","animations","isSkinnedMesh","loader","initLoader","loadPath","exporterSTL","STLExporter","exporterOBJ","OBJExporter","clock","THREE","animMixer","animTime","scene","createScene","showGroundPlane","showLight","ref","paddingTop","background","gp","depthWrite","rotation","x","PI","receiveShadow","add","hL","set","h","dL1","dL2","log","forSave","clone","remove","traverse","id","uuid","push","startsWith","forEach","getObjectById","parent","parse","binary","rSize","rendererDimensions","renderer","antialias","setPixelRatio","window","devicePixelRatio","setSize","height","current","appendChild","domElement","addEventListener","rendererTmb","alpha","thumbnailWidth","thumbnailHeight","camera","controls","OrbitControls","listenToKeyEvents","enableDamping","dampingFactor","screenSpacePanning","minDistance","maxDistance","maxPolarAngle","update","backgroundCube","loadBackgroundCube","loadObject","object3D","removeEventListener","d","innerWidth","innerHeight","rst","getComputedStyle","parseFloat","paddingLeft","paddingRight","paddingBottom","aspect","updateProjectionMatrix","dracoLoader","DRACOLoader","setDecoderPath","GLTFLoader","setDRACOLoader","filePath","load","undefined","file","loadedObject","availableElements","availableAnimations","rdr","FileReader","result","readAsArrayBuffer","filesCube","setPath","requestAnimationFrame","animSingleStep","setTime","mixerUpdateDelta","getDelta","render","glTF","children","opt","findOptional","omat","flatShading","bb","frustumCulled","isMesh","material","expandByObject","showBoundingBox","box","showSkeleton","skeleton","cameraToBBox","createElementThumbs","showDefaultOptional","loadAnimation","xhr","loaded","total","anim","tracks","t","times","animDisableMove","filter","act","clipAction","play","action","animSelect","el","namePath","split","oTitle","userData","Title","oDescription","Description","ent","Object","entries","sort","a","b","obj","time","fitOffset","size","center","getSize","getCenter","maxSize","y","z","fitHeightDistance","atan","fov","fitWidthDistance","distance","near","far","direction","sub","normalize","multiplyScalar","copy","move","pos","lookAt","elGroups","cameraAspect","cam","sceneBG","group","objRender","geometry","boundingBox","toDataURL","App","refDrawerMenu","refView3D","loadDragNDrop","loadDragOver","data","blobSTL","Blob","saveAs","blobOBJ","preventDefault","dataTransfer","dropEffect","files","types","kind","getAsFile","newGroups","groupDef","anims","process","onDrop","onDragOver","bottom","textAlign","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","ThemeProvider","CssBaseline","enableColorScheme","document","getElementById"],"mappings":"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","file":"static/js/main.7fe4f079.chunk.js","sourcesContent":["//import { red } from '@mui/material/colors';\nimport { createTheme } from '@mui/material/styles';\n\n// A custom theme for this app\nconst theme = createTheme({\n//\tpalette: {\n//\t\tprimary: {\n//\t\t\tmain: '#556cd6',\n//\t\t},\n//\t\tsecondary: {\n//\t\t\tmain: '#19857b',\n//\t\t},\n//\t\terror: {\n//\t\t\tmain: red.A400,\n//\t\t},\n//\t},\n});\n\nexport default theme;","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport AppBar from '@mui/material/AppBar';\nimport Toolbar from '@mui/material/Toolbar';\nimport Typography from '@mui/material/Typography';\nimport IconButton from '@mui/material/IconButton';\nimport MenuIcon from '@mui/icons-material/Menu';\n\nclass AppTools extends Component {\n\n\trender() {\n\t\treturn (\n\t\t\t<AppBar position=\"fixed\">\n\t\t\t\t<Toolbar variant=\"regular\">\n\t\t\t\t\t<IconButton edge=\"start\" color=\"inherit\" aria-label=\"menu\" onClick={this.props.toggleDrawer}>\n\t\t\t\t\t\t<MenuIcon />\n\t\t\t\t\t</IconButton>\n\t\t\t\t\t<Typography variant=\"h6\" color=\"inherit\">3D Print demo</Typography>\n\t\t\t\t</Toolbar>\n\t\t\t</AppBar>\n\t\t);\n\t}\n}\n\nAppTools.defaultProps = {\n\ttoggleDrawer: null\n}\n\nAppTools.propTypes = {\n\ttoggleDrawer: PropTypes.func\n}\n\nexport default AppTools;","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Divider from '@mui/material/Divider';\nimport Drawer from '@mui/material/Drawer';\nimport Box from '@mui/material/Box';\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemButton from '@mui/material/ListItemButton';\nimport ListItemIcon from '@mui/material/ListItemIcon';\nimport ListItemText from '@mui/material/ListItemText';\nimport Typography from '@mui/material/Typography';\nimport Save from '@mui/icons-material/Save';\n\nclass DrawerMenu extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.toggleDrawer = this.toggleDrawer.bind(this);\n\t\tthis.save = this.save.bind(this);\n\t\tthis.state = {\n\t\t\tisOpen: false\n\t\t}\n\t}\n\n\ttoggleDrawer(e) {\n\t\tif (e.type === 'keydown' && (e.key === 'Tab' || e.key === 'Shift')) {\n\t\t\treturn;\n\t\t}\n\t\tthis.setState({ isOpen: !this.state.isOpen });\n\t}\n\n\tsave(e) {\n\t\tif (null === this.props.save) {\n\t\t\tconsole.error(\"No save handler set\");\n\t\t\treturn;\n\t\t}\n\t\t// read from \"data-value\" attribute\n\t\tlet fileFormat = e.currentTarget.dataset.value;\n\t\tif (!fileFormat) {\n\t\t\tfileFormat = \"STL\" // default to STL format\n\t\t}\n\t\tthis.setState({ isOpen:false });\n\t\tthis.props.save(fileFormat);\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Drawer anchor=\"left\" open={this.state.isOpen} onClose={this.toggleDrawer}>\n\t\t\t\t<Box p={1}>\n\t\t\t\t\t<Typography variant=\"h4\" component=\"h4\">Main menu</Typography>\n\t\t\t\t\t<Divider />\n\t\t\t\t\t<List component=\"nav\" aria-label=\"main selector\">\n\t\t\t\t\t\t<ListItem>\n\t\t\t\t\t\t\t<ListItemButton onClick={this.save} data-value=\"STL\">\n\t\t\t\t\t\t\t\t<ListItemIcon><Save /></ListItemIcon>\n\t\t\t\t\t\t\t\t<ListItemText primary=\"Save STL for print\" />\n\t\t\t\t\t\t\t</ListItemButton>\n\t\t\t\t\t\t</ListItem>\n\t\t\t\t\t\t<ListItem>\n\t\t\t\t\t\t\t<ListItemButton onClick={this.save} data-value=\"OBJ\">\n\t\t\t\t\t\t\t\t<ListItemIcon><Save /></ListItemIcon>\n\t\t\t\t\t\t\t\t<ListItemText primary=\"Save OBJ for print\" />\n\t\t\t\t\t\t\t</ListItemButton>\n\t\t\t\t\t\t</ListItem>\n\t\t\t\t\t</List>\n\t\t\t\t</Box>\n\t\t\t</Drawer>\n\t\t);\n\t}\n}\n\nDrawerMenu.defaultProps = {\n\tsave: null\n}\n\nDrawerMenu.propTypes = {\n\tsave: PropTypes.func\n}\n\nexport default DrawerMenu;","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Paper from '@mui/material/Paper';\nimport FormLabel from '@mui/material/FormLabel';\nimport FormControl from '@mui/material/FormControl';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport Radio from '@mui/material/Radio';\nimport RadioGroup from '@mui/material/RadioGroup';\nimport Slider from '@mui/material/Slider';\nimport Box from '@mui/material/Box';\n\nclass AnimSelector extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.animFrameLabel = this.animFrameLabel.bind(this);\n\t\tthis.radioChange = this.radioChange.bind(this);\n\t\tthis.sliderChange = this.sliderChange.bind(this);\n\t}\n\n\tsliderChange(e) {\n\t\tconst v = e.target.value;\n\t\tconst o = this.findSelected(this.props.animPoses);\n\t\tif (null !== this.props.setAnimTime) {\n\t\t\tthis.props.setAnimTime(v * o.frameTime);\n\t\t}\n\t}\n\n\tfindSelected(opts) {\n\t\tfor (let i = 0; i < opts.length; i++) {\n\t\t\tif (opts[i].enabled) {\n\t\t\t\treturn opts[i];\n\t\t\t}\t\t\t\n\t\t}\n\t\treturn null;\n\t}\n\n\tanimFrameLabel(value) {\n\t\treturn `${value} frame`;\n\t}\n\n\trenderAnimFrames(opts) {\n\t\t// find selected anim\n\t\tconst o = this.findSelected(opts);\n\t\tif (null === o || 0 === o.frames) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst lbl = `SELECT FRAME (${o.frames} frm / ${Math.round(1 / o.frameTime, 2)}fps)`\n\n\t\treturn (\n\t\t\t<Paper sx={{p: 1, m: 1, opacity: 0.8 }}>\n\t\t\t\t\t<FormControl sx={{width: \"100%\"}}>\n\t\t\t\t\t\t<FormLabel component=\"legend\">{lbl}</FormLabel>\n\t\t\t\t\t\t<Box sx={{p: 1}}>\n\t\t\t\t\t\t\t<Slider\n\t\t\t\t\t\t\t\taria-label=\"Fames\"\n\t\t\t\t\t\t\t\tdefaultValue={0}\n\t\t\t\t\t\t\t\tgetAriaValueText={this.animFrameLabel}\n\t\t\t\t\t\t\t\tvalueLabelDisplay=\"auto\"\n\t\t\t\t\t\t\t\tmarks\n\t\t\t\t\t\t\t\tmin={0}\n\t\t\t\t\t\t\t\tmax={o.frames-1}\n\t\t\t\t\t\t\t\tstep={1}\n\t\t\t\t\t\t\t\tonChange={this.sliderChange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</FormControl>\n\t\t\t</Paper>\n\t\t);\n\t}\n\n\tradioChange(e) {\n\t\t//console.log(\"radio change ->\", e.target.value);\n\t\tif (null !==  this.props.toggleAnim) {\n\t\t\tthis.props.toggleAnim(e.target.value);\n\t\t}\n\t}\n\n\trenderRadioSelect(opts) {\n\t\t// find enabled\n\t\tlet val = '';\n\t\tfor (let i = 0; i < opts.length; i++) {\n\t\t\tif (opts[i].enabled) {\n\t\t\t\tval = opts[i].name;\n\t\t\t}\n\t\t}\n\n\t\treturn (\n\t\t\t<RadioGroup\n\t\t\t\taria-labelledby=\"demo-controlled-radio-buttons-group\"\n\t\t\t\tname=\"controlled-radio-buttons-group\"\n\t\t\t\tvalue={val}\n\t\t\t\tonChange={this.radioChange}>\n\t\t\t\t{this.renderRadios(opts)}\n\t\t\t</RadioGroup>\n\t\t);\n\t}\n\n\trenderRadios(opts) {\n\t\treturn opts.map((o, idx) => {\n\t\t\treturn (\n\t\t\t\t<FormControlLabel key={idx} label={o.name} value={o.name} control={<Radio />} />\n\t\t\t);\n\t\t});\n\t}\n\n\trender() {\n\t\tconst opts = this.props.animPoses;\n\t\treturn (\n\t\t\t<React.Fragment>\n\t\t\t\t<Paper sx={{p: 1, m: 1, opacity: 0.8 }}>\n\t\t\t\t\t<FormControl>\n\t\t\t\t\t\t<FormLabel component=\"legend\">SELECT POSE</FormLabel>\n\t\t\t\t\t\t{this.renderRadioSelect(opts)}\n\t\t\t\t\t</FormControl>\n\t\t\t\t</Paper>\n\t\t\t\t{this.renderAnimFrames(opts)}\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n}\n\nAnimSelector.defaultProps = {\n\tanimPoses: [],\n\ttoggleAnim: null,\n\tsetAnimTime: null\n}\n\nAnimSelector.propTypes = {\n\tanimPoses: PropTypes.array,\n\ttoggleAnim: PropTypes.func,\n\tsetAnimTime: PropTypes.func\n}\n\nexport default AnimSelector;","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Box from '@mui/material/Box';\nimport List from '@mui/material/List';\nimport ListSubheader from '@mui/material/ListSubheader';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemButton from '@mui/material/ListItemButton';\nimport ListItemText from '@mui/material/ListItemText';\nimport ListItemIcon from '@mui/material/ListItemIcon';\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack';\nimport ChevronRightIcon from '@mui/icons-material/ChevronRight';\nimport AccessibilityNewIcon from '@mui/icons-material/AccessibilityNew';\nimport EditIcon from '@mui/icons-material/Edit';\nimport AnimSelector from './AnimSelector';\nimport Paper from '@mui/material/Paper';\n\nclass MainSelector extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.menuSelected = this.menuSelected.bind(this);\n\t\tthis.elementCategorySelected = this.elementCategorySelected.bind(this);\n\t\tthis.state = {\n\t\t\tselectedOption: \"\"\n\t\t}\n\t}\n\n\tmenuSelected(e) {\n\t\t// read from \"data-value\" attribute\n\t\tconst menu = e.currentTarget.dataset.value;\n\t\tthis.setState({ selectedOption:menu });\n\t\t// reset category selection\n\t\tthis.props.selectElementCategory('');\n\t}\n\n\telementCategorySelected(e) {\n\t\t// read from \"data-value\" attribute\n\t\tconst c = e.currentTarget.dataset.value;\n\t\tthis.props.selectElementCategory(c);\n\t}\n\n\trenderCategoryOptions() {\n\t\tconst selected = this.props.elementCategory;\n\t\treturn this.props.elementGroups.map((g, idx) => {\n\t\t\tconst category = g[0];\n\t\t\treturn (\n\t\t\t\t<ListItem disablePadding selected={category === selected} key={idx}>\n\t\t\t\t\t<ListItemButton onClick={this.elementCategorySelected} data-value={category}>\n\t\t\t\t\t\t<ListItemText primary={category.toUpperCase()} />\n\t\t\t\t\t\t<ChevronRightIcon />\n\t\t\t\t\t</ListItemButton>\n\t\t\t\t</ListItem>\n\t\t\t);\n\t\t});\n\t}\n\n\trenderCategorySelector() {\n\t\tif (this.state.selectedOption !== \"configure\") {\n\t\t\treturn null;\n\t\t}\n\t\treturn (\n\t\t\t<Paper sx={{p: 0, m: 1, opacity: 0.8 }}>\n\t\t\t\t<List sx={{ width: '100%' }}>\n\t\t\t\t\t<ListSubheader component=\"div\">MODEL OPTIONS</ListSubheader>\n\t\t\t\t\t{this.renderCategoryOptions()}\n\t\t\t\t</List>\n\t\t\t</Paper>\n\t\t);\n\t}\n\n\trenderAnimSelector() {\n\t\tif (this.state.selectedOption !== \"pose\") {\n\t\t\treturn null;\n\t\t}\n\t\treturn (\n\t\t\t<AnimSelector animPoses={this.props.optAnimations} toggleAnim={this.props.toggleAnimation} setAnimTime={this.props.setAnimationTime} />\n\t\t);\n\t}\n\n\trenderDone(showDone) {\n\t\tif (!showDone) {\n\t\t\treturn null;\n\t\t}\n\t\treturn (\n\t\t\t<ListItem disablePadding>\n\t\t\t\t<ListItemButton onClick={this.menuSelected} data-value=\"\">\n\t\t\t\t\t<ListItemIcon>\n\t\t\t\t\t\t<ArrowBackIcon />\n\t\t\t\t\t</ListItemIcon>\n\t\t\t\t\t<ListItemText primary=\"DONE\" />\n\t\t\t\t</ListItemButton>\n\t\t\t</ListItem>\n\t\t);\n\t}\n\n\trenderOptions(showOptions) {\n\t\tif (!showOptions) {\n\t\t\treturn null;\n\t\t}\n\t\treturn (\n\t\t\t<React.Fragment>\n\t\t\t\t<ListItem disablePadding>\n\t\t\t\t\t<ListItemButton onClick={this.menuSelected} data-value=\"configure\">\n\t\t\t\t\t\t<ListItemIcon>\n\t\t\t\t\t\t\t<EditIcon />\n\t\t\t\t\t\t</ListItemIcon>\n\t\t\t\t\t\t<ListItemText primary=\"CONFIGURE MODEL\" />\n\t\t\t\t\t</ListItemButton>\n\t\t\t\t</ListItem>\n\t\t\t\t{this.props.optAnimations.length > 0 &&\n\t\t\t\t\t<ListItem disablePadding>\n\t\t\t\t\t\t<ListItemButton onClick={this.menuSelected} data-value=\"pose\">\n\t\t\t\t\t\t\t<ListItemIcon>\n\t\t\t\t\t\t\t\t<AccessibilityNewIcon />\n\t\t\t\t\t\t\t</ListItemIcon>\n\t\t\t\t\t\t\t<ListItemText primary=\"SELECT POSE\" />\n\t\t\t\t\t\t</ListItemButton>\n\t\t\t\t\t</ListItem>\n\t\t\t\t}\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst showDone = this.state.selectedOption !== \"\";\n\t\treturn (\n\t\t\t<Box sx={{ \n\t\t\t\twidth: 1/5,\n\t\t\t\tm: 2,\n\t\t\t\tzIndex: 'appBar', \n\t\t\t\tposition: 'absolute', \n\t\t\t\ttop: (theme) => theme.mixins.toolbar.minHeight + 'px'\n\t\t\t}}>\n\t\t\t\t<List sx={{ bgcolor: 'background.paper', opacity: 0.8, borderRadius: 1 }}>\n\t\t\t\t\t{this.renderDone(showDone)}\n\t\t\t\t\t{this.renderOptions(!showDone)}\n\t\t\t\t</List>\n\t\t\t\t{this.renderCategorySelector()}\n\t\t\t\t{this.renderAnimSelector()}\n\t\t\t</Box>\n\t\t);\n\t}\n}\n\nMainSelector.defaultProps = {\n\telementGroups: [],\n\ttoggleElement: null,\n\toptAnimations: [],\n\ttoggleAnimation: null,\n\tsetAnimationTime: null,\n\telementCategory: '',\n\tselectElementCategory: null\n}\n\nMainSelector.propTypes = {\n\telementGroups: PropTypes.array,\n\ttoggleElement: PropTypes.func,\n\toptAnimations: PropTypes.array,\n\ttoggleAnimation: PropTypes.func,\n\tsetAnimationTime: PropTypes.func,\n\telementCategory: PropTypes.string,\n\tselectElementCategory: PropTypes.func\n}\n\nexport default MainSelector;","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Box from '@mui/material/Box';\nimport Paper from '@mui/material/Paper';\nimport FormLabel from '@mui/material/FormLabel';\nimport FormControl from '@mui/material/FormControl';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport Checkbox from '@mui/material/Checkbox';\nimport Radio from '@mui/material/Radio';\nimport RadioGroup from '@mui/material/RadioGroup';\n\nclass CategorySelector extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.checkChange = this.checkChange.bind(this);\n\t\tthis.radioChange = this.radioChange.bind(this);\n\t}\n\t\n\tfindCategory(groups, category) {\n\t\tif (null === groups || null === category) {\n\t\t\treturn null;\n\t\t}\n\t\tfor (let i = 0; i < groups.length; i++) {\n\t\t\tif (category === groups[i][0]) {\n\t\t\t\treturn groups[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tcheckChange(e) {\n\t\tconst n = e.currentTarget.value;\n\t\tconst v = e.currentTarget.checked;\n\t\t//console.log(n, \"check change ->\", v);\n\t\tif (null !== this.props.toggleElement) {\n\t\t\tthis.props.toggleElement({key:n, visible:v});\n\t\t}\n\t}\n\n\tradioChange(e) {\n\t\t//console.log(\"radio change ->\", e.target.value);\n\t\tif (null !==  this.props.toggleElement) {\n\t\t\tthis.props.toggleElement({key:e.target.value, visible:true});\n\t\t}\n\t}\n\n\trenderCheckboxes(items) {\n\t\treturn items.map((i, idx) => {\n\t\t\treturn (\n\t\t\t\t<div key={idx}>\n\t\t\t\t\t<FormControlLabel label={i.name} value={i.key} control={<Checkbox checked={i.visible} onChange={this.checkChange} />} />\n\t\t\t\t\t<p style={{margin:0, padding:0}}>{i.description}</p>\n\t\t\t\t\t<img src={i.thumbnail} alt={i.name} />\n\t\t\t\t</div>\n\t\t\t);\n\t\t});\n\t}\n\n\trenderRadios(items) {\n\t\treturn items.map((i, idx) => {\n\t\t\treturn (\n\t\t\t\t<div key={idx}>\n\t\t\t\t\t<FormControlLabel label={i.name} value={i.key} control={<Radio />} />\n\t\t\t\t\t<p style={{margin:0, padding:0}}>{i.description}</p>\n\t\t\t\t\t<img src={i.thumbnail} alt={i.name} />\n\t\t\t\t</div>\n\t\t\t);\n\t\t});\n\t}\n\n\trenderRadioSelect(name, items) {\n\t\tlet val = '';\n\t\tfor (let i = 0; i < items.length; i++) {\n\t\t\tif (items[i].visible) {\n\t\t\t\tval = items[i].key;\n\t\t\t}\n\t\t}\n\n\t\treturn (\n\t\t\t<RadioGroup\n\t\t\t\tname={name}\n\t\t\t\tvalue={val}\n\t\t\t\tonChange={this.radioChange}>\n\t\t\t\t{this.renderRadios(items)}\n\t\t\t</RadioGroup>\n\t\t);\n\t}\n\n\trenderCategory(category) {\n\t\tlet dispName = category.name.toUpperCase();\n\t\tif (!dispName.endsWith('S')) {\n\t\t\tdispName += 'S';\n\t\t}\n\t\treturn (\n\t\t\t<Paper sx={{p: 1, m: 1, opacity: 0.8 }}>\n\t\t\t\t<FormLabel component=\"legend\">{dispName}</FormLabel>\n\t\t\t\t<FormControl>\n\t\t\t\t\t{category.singleSelect ? this.renderRadioSelect(category.name,category.items) : this.renderCheckboxes(category.items)}\n\t\t\t\t</FormControl>\n\t\t\t</Paper>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst category = this.findCategory(this.props.elementGroups, this.props.elementCategory);\n\t\tif (null === category) {\n\t\t\treturn null;\n\t\t}\n\t\treturn (\n\t\t\t<Box sx={{ \n\t\t\t\twidth: 1/5, m: 2,\n\t\t\t\tzIndex: 'appBar', position: 'absolute',\n\t\t\t\tright: 0, top: (theme) => theme.mixins.toolbar.minHeight + 'px'\n\t\t\t}}>\n\t\t\t\t{this.renderCategory(category[1])}\n\t\t\t</Box>\n\t\t);\n\t}\n}\n\nCategorySelector.defaultProps = {\n\telementCategory: null,\n\telementGroups: [],\n\ttoggleElement: null\n}\n\nCategorySelector.propTypes = {\n\telementCategory: PropTypes.string,\n\telementGroups: PropTypes.array,\n\ttoggleElement: PropTypes.func\n}\n\nexport default CategorySelector;","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport * as THREE from \"three\";\nimport Box from '@mui/material/Box';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\nimport { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader.js';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\nimport { STLExporter } from 'three/examples/jsm/exporters/STLExporter.js';\nimport { OBJExporter } from 'three/examples/jsm/exporters/OBJExporter.js';\n\nclass View3D extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.refRenderer = React.createRef();\n\t\t// methods\n\t\tthis.save = this.save.bind(this);\n\t\tthis.animate = this.animate.bind(this);\n\t\tthis.loadObjectDirect = this.loadObjectDirect.bind(this);\n\t\tthis.loaderOk = this.loaderOk.bind(this);\n\t\tthis.loaderAnimOk = this.loaderAnimOk.bind(this);\n\t\tthis.loaderError = this.loaderError.bind(this);\n\t\tthis.loaderProgress = this.loaderProgress.bind(this);\n\t\tthis.toggleElement = this.toggleElement.bind(this);\n\t\tthis.setAnimationTime = this.setAnimationTime.bind(this);\n\t\tthis.onWindowResize = this.onWindowResize.bind(this);\n\t\tthis.animations = [];\n\t\tthis.isSkinnedMesh = false;\n\n\t\tthis.loader = this.initLoader(props.loadPath);\n\t\t// Init exporters\n\t\tthis.exporterSTL = new STLExporter();\n\t\tthis.exporterOBJ = new OBJExporter();\n\n\t\t// init animation clock\n\t\tthis.clock = new THREE.Clock();\n\t\tthis.animMixer = null;\n\t\tthis.animTime = 0;\n\n\t\t// Init default scene\n\t\tthis.scene = this.createScene(this.props.showGroundPlane, this.props.showLight);\n\t}\n\n\t// just empty div to add renderer\n\trender() {\n\t\t// this is to make container below toolbar\n\t\t// theme access is possible through function generating sx\n\t\treturn (\n\t\t\t<Box ref={this.refRenderer} sx={{paddingTop: (theme) => theme.mixins.toolbar.minHeight + 'px'}} />\n\t\t);\n\t}\n\n\t// create default scene\n\tcreateScene(showGroundPlane, showLight) {\n\t\tconst scene = new THREE.Scene();\n\t\tscene.background = new THREE.Color( 0xafafaf );\n\t\t//scene.fog = new THREE.Fog( 0xa0a0a0, 10, 50 );\n\n\t\t// ground plane\n\t\tif (showGroundPlane) {\n\t\t\tconst gp = new THREE.Mesh(\n\t\t\t\tnew THREE.PlaneGeometry(2, 2),\n\t\t\t\tnew THREE.MeshPhongMaterial( { color: 0x888888, depthWrite: false } ) \n\t\t\t);\n\t\t\tgp.rotation.x = - Math.PI / 2;\n\t\t\tgp.receiveShadow = true;\n\t\t\tgp.name = \"hlp_ground_plane\";\n\t\t\tscene.add(gp);\n\t\t}\n\n\t\t// Lights from example\n\t\tconst hL = new THREE.HemisphereLight(0xffffff, 0x444444);\n\t\thL.position.set(0, 5, 0);\n\t\tscene.add(hL);\n\t\tif (showLight) {\n\t\t\tconst h = new THREE.HemisphereLightHelper(hL, 1, 0xff0000);\n\t\t\th.name = \"hlp_hL\";\n\t\t\tscene.add(h);\n\t\t}\n\n\t\t//const dirLight = new THREE.DirectionalLight( 0xffffff );\n\t\t//dirLight.position.set( - 3, 10, - 10 );\n\t\t//dirLight.castShadow = true;\n\t\t//dirLight.shadow.camera.top = 2;\n\t\t//dirLight.shadow.camera.bottom = - 2;\n\t\t//dirLight.shadow.camera.left = - 2;\n\t\t//dirLight.shadow.camera.right = 2;\n\t\t//dirLight.shadow.camera.near = 0.1;\n\t\t//dirLight.shadow.camera.far = 40;\n\t\t//scene.add( dirLight );\n\t\t\n\t\tconst dL1 = new THREE.DirectionalLight(0xffffff);\n\t\tdL1.position.set(2, 2, 2);\n\t\tscene.add(dL1);\n\t\tif (showLight) {\n\t\t\tconst h = new THREE.DirectionalLightHelper(dL1, 1, 0xff0000);\n\t\t\th.name = \"hlp_dL1\";\n\t\t\tscene.add(h);\n\t\t}\n\n\t\tconst dL2 = new THREE.DirectionalLight(0xffffff);\n\t\tdL2.position.set(-2, -2, -2 );\n\t\tscene.add(dL2);\n\t\tif (showLight) {\n\t\t\tconst h = new THREE.DirectionalLightHelper(dL2, 1, 0xff0000);\n\t\t\th.name = \"hlp_dL2\";\n\t\t\tscene.add(h);\n\t\t}\n\n\t\treturn scene;\n\t}\n\n\t// extract scene and save object\n\tsave(fileFormat) {\n\t\tconsole.log(\"Saving object\");\n\t\t// clone scene to remove hidden\n\t\tlet forSave = this.scene.clone();\n\t\t// find invisible to remove\n\t\tlet remove = [];\n\t\tforSave.traverse(function(o){\n\t\t\tif (!o.visible) {\n\t\t\t\tconsole.log(\"To remove\", o.name, o.id, o.uuid);\n\t\t\t\tremove.push(o.id);\n\t\t\t}\n\t\t\tif (o.name.startsWith('hlp_')) {\n\t\t\t\tremove.push(o.id);\n\t\t\t}\n\t\t});\n\t\t// finally remove invisible\n\t\tremove.forEach(id => {\n\t\t\tlet o = forSave.getObjectById(id);\n\t\t\to.parent.remove(o);\n\t\t});\n\t\t// return cleaned\n\t\tswitch (fileFormat) {\n\t\t\tcase \"OBJ\":\n\t\t\t\treturn this.exporterOBJ.parse(forSave)\n\t\t\tcase \"STL\":\n\t\t\tdefault:\n\t\t\t\treturn this.exporterSTL.parse(forSave, {binary:true});\n\t\t}\n\t}\n\n\t// init three.js renderer\n\tcomponentDidMount() {\n\t\t// renderer element\n\t\tconst rSize = this.rendererDimensions();\n\n\t\t// Main renderer\n\t\tthis.renderer = new THREE.WebGLRenderer({ antialias: true });\n\t\tthis.renderer.setPixelRatio( window.devicePixelRatio );\t// doubles pixels?!?\n\t\tthis.renderer.setSize(rSize.width, rSize.height);\n\t\t//this.renderer.shadowMap.enabled = true;\n\t\t// use ref as a mount point of the Three.js scene instead of the document.body\n\t\tthis.refRenderer.current.appendChild( this.renderer.domElement );\n\t\t// Add handler for resizing\n\t\twindow.addEventListener( 'resize', this.onWindowResize );\n\n\t\t// Thumbnail renderer\n\t\tthis.rendererTmb = new THREE.WebGLRenderer({ antialias: true, alpha: true });\n\t\tthis.rendererTmb.setSize(this.props.thumbnailWidth, this.props.thumbnailHeight);\n\n\t\t// setup camera\n\t\tthis.camera = new THREE.PerspectiveCamera( 45, rSize.width / rSize.height, 0.1, 100 );\n\t\tthis.camera.position.set(0, 0.2, 0.1);\n\n\t\t// camera controls\n\t\tthis.controls = new OrbitControls( this.camera, this.renderer.domElement );\n\t\tthis.controls.listenToKeyEvents( window ); // optional\n\t\tthis.controls.enableDamping = true; // an animation loop is required when either damping or auto-rotation are enabled\n\t\tthis.controls.dampingFactor = 0.05;\n\t\tthis.controls.screenSpacePanning = false;\n\t\tthis.controls.minDistance = 0.1;\n\t\tthis.controls.maxDistance = 2;\n\t\tthis.controls.maxPolarAngle = Math.PI / 2;\n\t\tthis.controls.target = new THREE.Vector3(0, 0.15, 0);\n\t\tthis.controls.update();\n\n\t\t// start animation\n\t\tthis.animate();\n\n\t\t// kickstart loading\n\t\tif (this.props.backgroundCube.length > 0) {\n\t\t\tthis.scene.background = this.loadBackgroundCube(this.props.backgroundCube);\n\t\t}\n\n\t\tthis.loadObject(this.props.object3D);\n\t}\n\n\tcomponentWillUnmount() {\n\t\t// remove handler for resizing\n\t\twindow.removeEventListener( 'resize', this.onWindowResize );\n\t}\n\n\trendererDimensions(){\n\t\tlet d = {\n\t\t\t//width: this.refRenderer.current.clientWidth,\n\t\t\twidth: window.innerWidth,\n\t\t\t//height: this.refRenderer.current.clientHeight\n\t\t\theight: window.innerHeight\n\t\t}\n\t\tlet rst = getComputedStyle(this.refRenderer.current);\n\t\td.width -= parseFloat(rst.paddingLeft) + parseFloat(rst.paddingRight);\n\t\td.height -= parseFloat(rst.paddingTop) + parseFloat(rst.paddingBottom);\n\t\treturn d;\n\t}\n\n\t// TODO: fix resizing \n\tonWindowResize() {\n\t\tconst rSize = this.rendererDimensions();\n\t\tthis.camera.aspect = rSize.width / rSize.height;\n\t\tthis.camera.updateProjectionMatrix();\n\t\tthis.controls.update();\n\t\tthis.renderer.setSize( rSize.width, rSize.height );\n\t}\n\n\tinitLoader(loadPath) {\n\t\t// glTF decompressor, with path for decompression lib loading\n\t\tconst dracoLoader = new DRACOLoader()\n\t\tdracoLoader.setDecoderPath(loadPath + '/libs/draco/')\n\t\t//dracoLoader.setDecoderConfig({type: 'js'});\t// (Optional) Override detection of WASM support.\n\t\t// init object loader with decompressor\n\t\tconst loader = new GLTFLoader();\n\t\tloader.setDRACOLoader(dracoLoader);\n\t\treturn loader;\n\t}\n\n\tloadObject(filePath){\n\t\tif (null === filePath) {\n\t\t\treturn;\n\t\t}\n\t\tthis.loader.load(\n\t\t\tthis.props.loadPath + filePath,\n\t\t\tthis.loaderOk,\n\t\t\tundefined, //this.loaderProgress,\n\t\t\tthis.loaderError\n\t\t);\n\t}\n\n\tloadObjectDirect(file) {\n\t\t//console.log(\"Loading direct\", file);\n\n\t\t// reset scene for new loading object\n\t\t// stupid but effective\n\t\tif (this.loadedObject) {\n\t\t\tthis.scene = this.createScene(this.props.showGroundPlane, this.props.showLight);\n\t\t\t// reset list of models\n\t\t\tif (null !== this.props.availableElements) {\n\t\t\t\tthis.props.availableElements([]);\n\t\t\t}\n\t\t\t// reset list of animations\n\t\t\tif (null !== this.props.availableAnimations) {\n\t\t\t\tthis.props.availableAnimations([]);\n\t\t\t}\n\t\t}\n\n\t\t// Load\n\t\tconst rdr = new FileReader();\n\t\trdr.addEventListener('load', e => {\n\t\t\tthis.loader.parse(e.target.result, '', this.loaderOk);\n\t\t});\n\t\trdr.addEventListener('error', e => { \n\t\t\tconsole.error(\"Error loading\", file.name, e);\n\t\t});\n\t\trdr.readAsArrayBuffer(file);\n\t}\n\n\tloadAnimation(filePath) {\n\t\tif (null === filePath) {\n\t\t\treturn;\n\t\t}\n\t\tthis.loader.load(\n\t\t\tthis.props.loadPath + filePath,\n\t\t\tthis.loaderAnimOk,\n\t\t\tundefined, //this.loaderProgress,\n\t\t\tthis.loaderError\n\t\t);\n\t}\n\n\n\tloadBackgroundCube(filesCube) {\n\t\tif (null === filesCube) {\n\t\t\treturn;\n\t\t}\n\t\treturn new THREE.CubeTextureLoader()\n\t\t\t.setPath(this.props.loadPath)\n\t\t\t.load(filesCube);\n\t}\n\n\tanimate() {\n\t\trequestAnimationFrame( this.animate );\n\n\t\t// only when object is loaded and we have mixer\n\t\tif (null !== this.animMixer) {\n\t\t\tif (this.props.animSingleStep) {\n\t\t\t\t// for single step use time set\n\t\t\t\tthis.animMixer.setTime(this.animTime);\n\t\t\t} else {\n\t\t\t\t// Get the time elapsed since the last frame, used for mixer update (if not in single step mode)\n\t\t\t\tlet mixerUpdateDelta = this.clock.getDelta();\n\t\t\t\t// Update the animation mixer, the stats panel, and render this frame\n\t\t\t\tthis.animMixer.update( mixerUpdateDelta / 2 );\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.renderer.render( this.scene, this.camera );\n\t};\n\n\t// called when object is loaded\n\tloaderOk(glTF) {\n\t\t//console.log(glTF);\n\t\t// Pick only first object in scene\n\t\t//this.loadedObject = glTF.scene;\n\t\tthis.loadedObject = glTF.scene.children[0];\n\n\t\t// check skinned\n\t\tthis.isSkinnedMesh = false;\n\t\tthis.loadedObject.traverse((o) => {\n\t\t\tif (this.isSkinnedMesh) { return; }\n\t\t\tif (o.isSkinnedMesh) { this.isSkinnedMesh = true; }\n\t\t});\n\n\t\t// find optional elements\n\t\tlet opt = this.findOptional();\n\n\t\tconst omat = new THREE.MeshPhongMaterial( { color: 0x226622, flatShading: true } )\n\t\t// enable shadow and set material, must have directional light, calc bounding box\n\t\tlet bb = new THREE.Box3();\n\t\t//this.loadedObject.frustumCulled = false;\n\t\tthis.loadedObject.traverse((o) => {\n\t\t\t// disable hiding object that are not fully in in frustum\n\t\t\to.frustumCulled = false;\n\t\t\tif ( !o.isMesh ) { return; }\n\t\t\t//o.castShadow = true;\n\t\t\to.material = omat;\n\t\t\tif (this.isSkinnedMesh) {\n\t\t\t\t// NOTE: Working with skinned mesh\n\t\t\t\tbb.expandByObject(o);\t// calc bounding box\n\t\t\t}\n\t\t});\n\t\tif (!this.isSkinnedMesh) {\n\t\t\t// NOTE: Working with non skinned mesh\n\t\t\tbb.expandByObject(this.loadedObject);\t// calc bounding box\n\t\t}\n\n\t\t// object to scene\n\t\tthis.scene.add(this.loadedObject);\n\n\t\t// display bounding box\n\t\tif (this.props.showBoundingBox) {\n\t\t\tconst box = new THREE.Box3Helper(bb, 0xff0000)\n\t\t\tbox.name = \"hlp_bounding_box\";\n\t\t\tthis.scene.add( box );\n\t\t}\n\n\t\t// visible skeleton\n\t\tif (this.props.showSkeleton) {\n\t\t\tconst skeleton = new THREE.SkeletonHelper(this.loadedObject);\n\t\t\tskeleton.name = 'hlp_skeleton';\n\t\t\tskeleton.visible = true;\n\t\t\tthis.scene.add( skeleton );\n\t\t}\n\n\t\t// adjust camera to object loaded\n\t\tthis.cameraToBBox(bb, this.camera, this.controls, 1.0);\n\n\t\t// create thumbnails\n\t\t// WARN: Can' do it with cloned scene, all geometry is trashed!!!!\n\t\t// Working here with default scene\n\t\tthis.createElementThumbs(opt, this.props.thumbnailWidth / this.props.thumbnailHeight);\n\n\t\t// preselect default optional elements\n\t\tthis.showDefaultOptional(opt);\n\n\t\t// create mixer for animations\n\t\tthis.animMixer = new THREE.AnimationMixer(this.loadedObject);\n\t\t\n\t\t// Call changed list of models\n\t\tif (null !== this.props.availableElements) {\n\t\t\t//console.log(opt)\n\t\t\tthis.props.availableElements(opt);\n\t\t}\n\n\t\t// clear all previous animations\n\t\tthis.animations = [];\n\t\t// call animation loading\n\t\tif (this.isSkinnedMesh) {\n\t\t\tfor (let i = 0; i < this.props.animPoses.length; i++) {\n\t\t\t\tthis.loadAnimation(this.props.animPoses[i]);\n\t\t\t}\n\t\t}\n\t}\n\n\t// called while loading is progressing\n\tloaderProgress (xhr) {\n\t\tconsole.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );\n\t}\n\n\t// called when object load fails\n\tloaderError(error) {\n\t\tconsole.error(error);\n\t}\n\n\t// animation is loaded\n\tloaderAnimOk(glTF) {\n\t\t//console.log(glTF);\n\t\t// only first animation\n\t\tconst anim = glTF.animations[0];\n\n\t\t// find max frame count and frame time\n\t\tlet frames = 0;\n\t\tlet frameTime = 0;\n\t\tanim.tracks.forEach((t) => {\n\t\t\tif (t.times.length > frames) {\n\t\t\t\tframes = t.times.length;\n\t\t\t\tframeTime = t.times[0];\n\t\t\t}\n\t\t});\n\n\t\t// remove model positioning\n\t\tif (this.props.animDisableMove) {\n\t\t\tanim.tracks = anim.tracks.filter(t => t.name !== \"mixamorigHips.position\")\n\t\t}\n\n\t\t// create disabled action\n\t\tconst act = this.animMixer.clipAction(anim);\n\t\tact.enabled = false;\n\t\tact.play();\n\n\t\t// add animation to list\n\t\tthis.animations.push({\n\t\t\tname: anim.name,\n\t\t\taction: act,\n\t\t\tframes: frames,\n\t\t\tframeTime: frameTime\n\t\t});\n\n\t\t// check all loaded to push list\n\t\tif (this.props.animPoses.length !== this.animations.length) {\n\t\t\treturn;\n\t\t}\n\n\t\t// crate anim selection\n\t\tlet animSelect = [];\n\t\tanimSelect.push({\n\t\t\tname: 'None', \n\t\t\tenabled: true,\n\t\t\tframes: 0,\n\t\t\tframeTime: 0\n\t\t});\n\t\tfor (let i = 0; i < this.animations.length; i++) {\n\t\t\tanimSelect.push({\n\t\t\t\tname: this.animations[i].name,\n\t\t\t\tenabled: false,\n\t\t\t\tframes: this.animations[i].frames,\n\t\t\t\tframeTime: this.animations[i].frameTime\n\t\t\t});\n\t\t}\n\t\tif (null !== this.props.availableAnimations) {\n\t\t\tthis.props.availableAnimations(animSelect);\n\t\t}\n\t}\n\n\t// finds optional objects name starting with prefix \"opt_\"\n\tfindOptional() {\n\t\tlet el = {};\n\t\tthis.loadedObject.traverse((o) => {\n\t\t\t// skip non optional objects\n\t\t\tif (!(o.name.startsWith(\"opts_\") || o.name.startsWith(\"optm_\"))) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// name path is opt_[category]_[item]\n\t\t\tlet namePath = o.name.split('_');\n\t\t\tlet category = namePath[1];\n\t\t\tif (undefined === el[category]) {\n\t\t\t\tlet singleSelect = 'opts' === namePath[0];\n\t\t\t\tel[category] = {\n\t\t\t\t\tname: category,\n\t\t\t\t\tsingleSelect: singleSelect,\n\t\t\t\t\titems: []\n\t\t\t\t}\n\t\t\t}\n\t\t\t//console.log(o.name, o.userData);\n\n\t\t\t// set title from userData if present\n\t\t\tlet oTitle = namePath[1] + ' ' + namePath[2];\n\t\t\tif (o.userData && o.userData.Title && o.userData.Title.length > 0) {\n\t\t\t\toTitle = o.userData.Title;\n\t\t\t}\n\n\t\t\t// set description from userData if present\n\t\t\tlet oDescription = '';\n\t\t\tif (o.userData && o.userData.Description && o.userData.Description.length > 0) {\n\t\t\t\toDescription = o.userData.Description;\n\t\t\t}\n\n\t\t\t// add to list for hide/show\n\t\t\tel[category].items.push({\n\t\t\t\tkey: o.name,\n\t\t\t\tname: oTitle,\n\t\t\t\tdescription: oDescription,\n\t\t\t\tvisible: false,\n\t\t\t\tthumbnail: null\n\t\t\t});\n\t\t});\n\t\t// sort categories\n\t\tlet ent = Object.entries(el).sort((a,b) => {\n\t\t\tif (a[0] < b[0]) { return -1; }\n\t\t\tif (a[0] > b[0]) { return 1; }\n\t\t\treturn 0;\n\t\t});\n\t\t// sort items in category\n\t\tent.forEach((e) => {\n\t\t\te[1].items = e[1].items.sort((a,b) => {\n\t\t\t\tif (a.name < b.name) { return -1; }\n\t\t\t\tif (a.name > b.name) { return 1; }\n\t\t\t\treturn 0;\n\t\t\t});\n\t\t})\n\t\treturn ent;\n\t}\n\n\t// makes default selection\n\tshowDefaultOptional(opt) {\n\t\t// show all meshes in object except optional\n\t\tthis.loadedObject.traverse((o) => {\n\t\t\tif (o.isMesh && !o.name.startsWith(\"opts_\") && !o.name.startsWith(\"optm_\")) { o.visible = true; }\n\t\t});\n\n\t\t// make default selection\n\t\topt.forEach((o) => {\n\t\t\t// skip preselect when only one optional element in group\n\t\t\tif (1 === o[1].items.length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// preselect first in group\n\t\t\to[1].items[0].visible = true;\n\t\t\tthis.toggleElement(o[1].items[0]);\n\t\t})\n\t}\n\n\t// toggle visible element, check for traversing scene..\n\t// https://github.com/mrdoob/three.js/blob/dev/examples/jsm/exporters/STLExporter.js\n\ttoggleElement(el) {\n\t\t//console.log(\"Toggle visible\", el);\n\t\tthis.loadedObject.traverse( function(obj) {\n\t\t\tif (obj.name === el.key) {\n\t\t\t\tobj.visible = el.visible;\n\t\t\t}\n\t\t});\n\t}\n\n\ttoggleAnimation(name) {\n\t\t//console.log(\"Toggle animation\", name);\n\t\tfor (let i = 0; i < this.animations.length; i++) {\n\t\t\tthis.animations[i].action.enabled = this.animations[i].name === name;\n\t\t}\n\t\t// reset current animation position\n\t\tthis.animTime = 0;\n\t}\n\n\tsetAnimationTime(time) {\n\t\tthis.animTime = time;\n\t}\n\n\t// point camera and controls to bounding box\n\t// see: https://discourse.threejs.org/t/camera-zoom-to-fit-object/936/6?page=2\n\tcameraToBBox(box, camera, controls, fitOffset = 1.2) {\n\t\tconst size = new THREE.Vector3();\n\t\tconst center = new THREE.Vector3();\n\t\tbox.getSize(size);\n\t\tbox.getCenter(center);\n\n\t\tconst maxSize = Math.max(size.x, size.y, size.z);\n\t\tconst fitHeightDistance = maxSize / (2 * Math.atan(Math.PI * camera.fov / 360));\n\t\tconst fitWidthDistance = fitHeightDistance / camera.aspect;\n\t\tconst distance = fitOffset * Math.max(fitHeightDistance, fitWidthDistance);\n\n\t\tcamera.near = distance / 100;\n\t\tcamera.far = distance * 100;\n\t\tcamera.updateProjectionMatrix();\n\n\t\tif (null !== controls) {\n\t\t\tconst direction = controls.target.clone()\n\t\t\t\t.sub(camera.position)\n\t\t\t\t.normalize()\n\t\t\t\t.multiplyScalar(distance);\n\t\t\t\n\t\t\tcontrols.maxDistance = distance * 2;\n\t\t\tcontrols.target.copy(center);\n\n\t\t\tcamera.position.copy(controls.target).sub(direction);\n\n\t\t\tcontrols.update();\n\t\t} else {\n\t\t\t/*\n\t\t\tconst direction = center.clone()\n\t\t\t\t.sub(camera.position)\n\t\t\t\t.normalize()\n\t\t\t\t.multiplyScalar(distance);\n\t\t\tcamera.position.copy(center).sub(direction);\n\t\t\tcamera.lookAt(center);\n\t\t\t*/\n\t\t\t\n\t\t\tconst move = new THREE.Vector3(0,0,distance);\n\t\t\tconst pos = center.clone()\n\t\t\t\t.add(move);\n\n\t\t\tcamera.position.set(pos.x, pos.y, pos.z);\n\t\t\tcamera.lookAt(center);\n\t\t}\n\t}\n\n\t// create thumbnail pictures for each optional element\n\tcreateElementThumbs(elGroups, cameraAspect) {\n\t\t// setup thumbnail camera\n\t\tconst cam = new THREE.PerspectiveCamera(75, cameraAspect, 0.1, 100);\n\t\tcam.position.set(0, 0.20, 20.0);\n\n\t\t// hide all meshes in object\n\t\tthis.loadedObject.traverse((o) => {\n\t\t\tif (o.isMesh) { o.visible = false; }\n\t\t});\n\n\t\t// hide scene helper objects\n\t\tthis.scene.traverse((o) => {\n\t\t\tif (o.name.startsWith('hlp_')) { o.visible = false; }\n\t\t});\n\n\t\t// save scene background\n\t\tconst sceneBG = this.scene.background;\n\t\tthis.scene.background = null;\n\n\t\t// test render only selected tmb\n\t\tconst tmb_render = '';\n\t\t//const tmb_render = 'opt_head_01';\n\n\t\t// create thumbnails\n\t\telGroups.forEach((group) => {\n\t\t\tgroup[1].items.forEach((el) => {\n\t\t\t\tif (tmb_render.length > 0 && !el.key.startsWith(tmb_render)) { return; }\n\n\t\t\t\t// find object to render\n\t\t\t\tlet objRender = null;\n\t\t\t\tconst bb = new THREE.Box3();\n\t\t\t\tthis.loadedObject.traverse((o) => {\n\t\t\t\t\tif (o.name === el.key) { objRender = o; }\n\t\t\t\t});\n\n\t\t\t\t// calc bounding box\n\t\t\t\tif (this.isSkinnedMesh) {\n\t\t\t\t\t// take copy of mesh bounding box\n\t\t\t\t\t// NOTE: working with skinned model\n\t\t\t\t\tbb.copy(objRender.geometry.boundingBox);\n\t\t\t\t} else {\n\t\t\t\t\t// NOTE: Working with non skinned model\n\t\t\t\t\tbb.expandByObject(objRender);\n\t\t\t\t}\n\n\t\t\t\t/* test bounding box\n\t\t\t\tconst box = new THREE.Box3Helper(bb, 0xff0000)\n\t\t\t\tbox.name = \"hlp_bb_\" + el.key;\n\t\t\t\tthis.scene.add( box );\n\t\t\t\t*/\n\t\t\n\t\t\t\t// position camera to thumbnail\n\t\t\t\tthis.cameraToBBox(bb, cam, null, 1.2);\n\n\t\t\t\t//const camHelper = new THREE.CameraHelper(cam);\n\t\t\t\t//this.scene.add( camHelper );\n\n\t\t\t\t// render\n\t\t\t\tobjRender.visible = true;\t\t// make it visible\n\t\t\t\tthis.rendererTmb.render(this.scene, cam);\n\t\t\t\tel.thumbnail = this.rendererTmb.domElement.toDataURL();\n\t\t\t\tobjRender.visible = false;\t\t// hide it again\n\t\t\t});\n\t\t});\n\n\t\t// restore scene background\n\t\tthis.scene.background = sceneBG;\n\t\t// restore scene helper objects\n\t\tthis.scene.traverse((o) => {\n\t\t\tif (o.name.startsWith('hlp_')) { o.visible = true; }\n\t\t});\n\t}\n}\n\nView3D.defaultProps = {\n\tloadPath: null,\n\tobject3D: null,\n\tanimPoses: null,\n\tshowBoundingBox: false,\n\tshowSkeleton: false,\n\tshowGroundPlane: true,\n\tshowLight: false,\n\tbackgroundCube: null,\n\tavailableElements: null,\n\tavailableAnimations: null,\n\tanimSingleStep: true,\n\tanimDisableMove: true,\n\tthumbnailWidth: 256,\n\tthumbnailHeight: 256\n}\n\nView3D.propTypes = {\n\tloadPath: PropTypes.string,\n\tobject3D: PropTypes.string,\n\tanimPoses: PropTypes.array,\n\tshowBoundingBox: PropTypes.bool,\n\tshowSkeleton: PropTypes.bool,\n\tshowGroundPlane: PropTypes.bool,\n\tshowLight: PropTypes.bool,\n\tbackgroundCube: PropTypes.array,\n\tavailableElements: PropTypes.func,\n\tavailableAnimations: PropTypes.func,\n\tanimSingleStep: PropTypes.bool,\n\tanimDisableMove: PropTypes.bool,\n\tthumbnailWidth: PropTypes.number,\n\tthumbnailHeight: PropTypes.number\n}\n\nexport default View3D;","import React, { Component } from 'react';\nimport AppTools from './ui/AppTools';\nimport DrawerMenu from './ui/DrawerMenu';\nimport MainSelector from './ui/MainSelector';\nimport CategorySelector from './ui/CategorySelector';\nimport Paper from '@mui/material/Paper';\nimport View3D from './editor/View3D';\nimport Typography from '@mui/material/Typography';\nimport { saveAs } from 'file-saver';\n\nclass App extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\telementCategory: '',\n\t\t\telementGroups: [],\n\t\t\tanimations: []\n\t\t}\n\t\tthis.refDrawerMenu = React.createRef();\n\t\tthis.refView3D = React.createRef();\n\t\tthis.toggleDrawer = this.toggleDrawer.bind(this);\n\t\tthis.save = this.save.bind(this);\n\t\tthis.availableElements = this.availableElements.bind(this);\n\t\tthis.toggleElement = this.toggleElement.bind(this);\n\t\tthis.availableAnimations = this.availableAnimations.bind(this);\n\t\tthis.toggleAnimation = this.toggleAnimation.bind(this);\n\t\tthis.setAnimationTime = this.setAnimationTime.bind(this);\n\t\tthis.selectElementCategory = this.selectElementCategory.bind(this);\n\t\tthis.loadDragNDrop = this.loadDragNDrop.bind(this);\n\t\tthis.loadDragOver = this.loadDragOver.bind(this);\n\t}\n\n\ttoggleDrawer(e) {\n\t\tthis.refDrawerMenu.current.toggleDrawer(e);\n\t}\n\n\tsave(fileFormat) {\n\t\t// get data from scene\n\t\tlet data = this.refView3D.current.save(fileFormat);\n\t\t//console.log(\"Data for save ->\", data);\n\t\tswitch (fileFormat) {\n\t\t\tcase \"STL\":\n\t\t\t\tlet blobSTL = new Blob( [data], { type : 'application/octet-stream' } ); \n\t\t\t\tsaveAs(blobSTL, \"for-print.stl\");\n\t\t\t\tbreak;\n\t\t\tcase \"OBJ\":\n\t\t\t\tlet blobOBJ = new Blob( [ data ], { type: 'text/plain' } );\n\t\t\t\tsaveAs(blobOBJ, \"for-print.obj\");\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.log(\"Unsupported file format ->\",fileFormat);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t// Prevent default behavior (Prevent file from being opened)\n\tloadDragOver(e) {\n\t\te.preventDefault();\n\t\te.dataTransfer.dropEffect = 'copy';\n\t\t//console.log('File(s) in drop zone');\n\t}\n\n\tloadDragNDrop(e) {\n\t\te.preventDefault();\n\t\tconsole.log(\"Drag & Drop files, items:\", e.dataTransfer.items.length, \"files:\", e.dataTransfer.files.length);\n\t\tif (e.dataTransfer.types[0] === 'text/plain') return; // Outliner drop\n\t\tif ( e.dataTransfer.items ) {\n\t\t\t// Use DataTransferItemList interface to access the file(s)\n\t\t\tfor (let i = 0; i < e.dataTransfer.items.length; i++) {\n\t\t\t\t// If dropped items aren't files, reject them\n\t\t\t\tif (e.dataTransfer.items[i].kind === 'file') {\n\t\t\t\t\tlet file = e.dataTransfer.items[i].getAsFile();\n\t\t\t\t\t//console.log('DataTransferItemList file[' + i + '].name = ' + file.name, file);\n\t\t\t\t\tthis.refView3D.current.loadObjectDirect(file);\n\t\t\t\t\t// loading only one file\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Use DataTransfer interface to access the file(s)\n\t\t\tfor (let i = 0; i < e.dataTransfer.files.length; i++) {\n\t\t\t\t//console.log('DataTransfer file[' + i + '].name = ' + e.dataTransfer.files[i].name, e.dataTransfer.files[i]);\n\t\t\t\tthis.refView3D.current.loadObjectDirect(e.dataTransfer.files[i]);\n\t\t\t\t// loading only one file\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Set list of grouped elements to hide and show\n\tavailableElements(groups) {\n\t\tthis.setState({elementGroups:groups});\n\t}\n\n\tselectElementCategory(category) {\n\t\tthis.setState({elementCategory:category});\n\t}\n\n\ttoggleElement(el) {\n\t\tconst namePath = el.key.split('_');\n\t\tlet newGroups = this.state.elementGroups.map((groupDef)=> {\n\t\t\t// Not same group skip check\n\t\t\tif (namePath[1] !== groupDef[0]) {\n\t\t\t\treturn groupDef\n\t\t\t}\n\t\t\tconst group = groupDef[1];\n\t\t\t//const isRadio = group.items.length > 1;\n\t\t\tgroup.items = group.items.map((e) => {\n\t\t\t\t// change state of element\n\t\t\t\tif (e.key === el.key) {\n\t\t\t\t\te.visible = el.visible;\n\t\t\t\t\tthis.refView3D.current.toggleElement(e);\n\t\t\t\t} else {\n\t\t\t\t\t// when is radio selection toggle invert previous selection\n\t\t\t\t\tif (group.singleSelect) {\n\t\t\t\t\t\te.visible = !el.visible;\n\t\t\t\t\t\tthis.refView3D.current.toggleElement(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn e;\n\t\t\t});\n\t\t\treturn groupDef;\n\t\t});\n\t\tthis.setState({elementGroups:newGroups});\n\t}\n\n\t// Set list of animations for selection\n\tavailableAnimations(animations) {\n\t\tthis.setState({animations:animations});\n\t}\n\t\n\ttoggleAnimation(name) {\n\t\tlet anims = this.state.animations.map((a) => {\n\t\t\ta.enabled = a.name === name;\n\t\t\treturn a;\n\t\t})\n\t\tthis.refView3D.current.toggleAnimation(name);\n\t\tthis.setState({animations:anims});\n\t}\n\n\tsetAnimationTime(time) {\n\t\tthis.refView3D.current.setAnimationTime(time);\n\t}\n\n\trender() {\n\t\t// Cubemaps\n\t\tconst bgCube=[];\n\t\t//const bgCube=[\n\t\t//\t'/textures/Brudslojan/posx.jpg',\n\t\t//\t'/textures/Brudslojan/negx.jpg',\n\t\t//\t'/textures/Brudslojan/posy.jpg',\n\t\t//\t'/textures/Brudslojan/negy.jpg',\n\t\t//\t'/textures/Brudslojan/posz.jpg',\n\t\t//\t'/textures/Brudslojan/negz.jpg'\n\t\t//];\n\n\t\tconst animPoses=[\n\t\t\t'/anims/fire_rifle.gltf',\n\t\t\t'/anims/hit_reaction.gltf',\n\t\t\t'/anims/reloading.gltf',\n\t\t\t'/anims/rifle_aiming.gltf',\n\t\t\t'/anims/rifle_jump.gltf',\n\t\t\t'/anims/rifle_run.gltf',\n\t\t\t'/anims/run_backwards.gltf',\n\t\t\t'/anims/starfe_left.gltf',\n\t\t\t'/anims/starfe_right.gltf',\n\t\t\t'/anims/toss_grenade.gltf',\n\t\t\t'/anims/turn_left.gltf',\n\t\t\t'/anims/turn_right.gltf',\n\t\t\t'/anims/walking_backwards.gltf',\n\t\t\t'/anims/walking.gltf'\n\t\t];\n\n\t\treturn (\n\t\t\t//object3D=\"/objects/rhodesia-solider-02.glb\"\n\t\t\t//object3D=\"/objects/Test_model2.glb\"\n\t\t\t<React.Fragment>\n\t\t\t\t<AppTools toggleDrawer={this.toggleDrawer} />\n\t\t\t\t<DrawerMenu ref={this.refDrawerMenu} save={this.save} />\n\t\t\t\t<View3D ref={this.refView3D} loadPath={process.env.PUBLIC_URL} \n\t\t\t\t\tobject3D=\"/objects/Test_model2.glb\"\n\t\t\t\t\tbackgroundCube={bgCube}\n\t\t\t\t\tanimPoses={animPoses}\n\t\t\t\t\tavailableElements={this.availableElements}\n\t\t\t\t\tavailableAnimations={this.availableAnimations}\n\t\t\t\t\tthumbnailWidth={128}\n\t\t\t\t\tthumbnailHeight={128} />\n\t\t\t\t<MainSelector \n\t\t\t\t\telementGroups={this.state.elementGroups}\n\t\t\t\t\ttoggleElement={this.toggleElement}\n\t\t\t\t\toptAnimations={this.state.animations}\n\t\t\t\t\ttoggleAnimation={this.toggleAnimation}\n\t\t\t\t\tsetAnimationTime={this.setAnimationTime}\n\t\t\t\t\telementCategory={this.state.elementCategory}\n\t\t\t\t\tselectElementCategory={this.selectElementCategory} />\n\t\t\t\t<CategorySelector\n\t\t\t\t\telementCategory={this.state.elementCategory}\n\t\t\t\t\telementGroups={this.state.elementGroups}\n\t\t\t\t\ttoggleElement={this.toggleElement} />\n\t\t\t\t<Paper onDrop={this.loadDragNDrop} onDragOver={this.loadDragOver} sx={{\n\t\t\t\t\tm: 1, p: 1,\n\t\t\t\t\tbottom: 0, right: 0,\n\t\t\t\t\twidth: 1/5,\n\t\t\t\t\ttextAlign: 'center',\n\t\t\t\t\tzIndex: 'appBar', \n\t\t\t\t\tposition: 'absolute' }}>\n\t\t\t\t\t\t<Typography variant=\"h6\" component=\"p\">\n\t\t\t\t\t\tDrag & Drop<br/>test model here\n\t\t\t\t\t\t</Typography>\n\t\t\t\t</Paper>\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n\tif (onPerfEntry && onPerfEntry instanceof Function) {\n\t\timport('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n\t\t\tgetCLS(onPerfEntry);\n\t\t\tgetFID(onPerfEntry);\n\t\t\tgetFCP(onPerfEntry);\n\t\t\tgetLCP(onPerfEntry);\n\t\t\tgetTTFB(onPerfEntry);\n\t\t});\n\t}\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport CssBaseline from '@mui/material/CssBaseline';\nimport { ThemeProvider } from '@mui/material/styles';\nimport theme from './theme';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<ThemeProvider theme={theme}>\n\t\t\t<CssBaseline enableColorScheme />\n\t\t\t{/* The rest of your application */}\n\t\t\t<App />\n\t\t</ThemeProvider>\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}