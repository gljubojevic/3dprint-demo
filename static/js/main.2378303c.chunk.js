(this["webpackJsonp3dprint-demo"]=this["webpackJsonp3dprint-demo"]||[]).push([[0],{128:function(e,t,n){},138:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(42),s=n.n(r),o=(n(128),n(188)),l=n(184),c=n(110),d=Object(c.a)({}),h=n(2),u=n(3),m=n(18),b=n(6),p=n(7),g=n(189),j=n(190),v=n(192),f=n(191),O=n(100),x=n.n(O),k=n(1),w=function(e){Object(b.a)(n,e);var t=Object(p.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(k.jsx)(g.a,{position:"fixed",children:Object(k.jsxs)(j.a,{variant:"regular",children:[Object(k.jsx)(f.a,{edge:"start",color:"inherit","aria-label":"menu",onClick:this.props.toggleDrawer,children:Object(k.jsx)(x.a,{})}),Object(k.jsx)(v.a,{variant:"h6",color:"inherit",children:"3D Print demo"})]})})}}]),n}(a.Component);w.defaultProps={toggleDrawer:null};var y=w,E=n(194),A=n(178),S=n(193),C=n(195),T=n(183),D=n(176),P=n(196),L=n(197),M=n(90),_=n.n(M),R=function(e){Object(b.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).toggleDrawer=a.toggleDrawer.bind(Object(m.a)(a)),a.save=a.save.bind(Object(m.a)(a)),a.state={isOpen:!1},a}return Object(u.a)(n,[{key:"toggleDrawer",value:function(e){("keydown"!==e.type||"Tab"!==e.key&&"Shift"!==e.key)&&this.setState({isOpen:!this.state.isOpen})}},{key:"save",value:function(e){if(null!==this.props.save){var t=e.currentTarget.dataset.value;t||(t="STL"),this.setState({isOpen:!1}),this.props.save(t)}else console.error("No save handler set")}},{key:"render",value:function(){return Object(k.jsx)(A.a,{anchor:"left",open:this.state.isOpen,onClose:this.toggleDrawer,children:Object(k.jsxs)(S.a,{p:1,children:[Object(k.jsx)(v.a,{variant:"h4",component:"h4",children:"Main menu"}),Object(k.jsx)(E.a,{}),Object(k.jsxs)(C.a,{component:"nav","aria-label":"main selector",children:[Object(k.jsx)(T.a,{children:Object(k.jsxs)(D.a,{onClick:this.save,"data-value":"STL",children:[Object(k.jsx)(P.a,{children:Object(k.jsx)(_.a,{})}),Object(k.jsx)(L.a,{primary:"Save STL for print"})]})}),Object(k.jsx)(T.a,{children:Object(k.jsxs)(D.a,{onClick:this.save,"data-value":"OBJ",children:[Object(k.jsx)(P.a,{children:Object(k.jsx)(_.a,{})}),Object(k.jsx)(L.a,{primary:"Save OBJ for print"})]})})]})]})})}}]),n}(a.Component);R.defaultProps={save:null};var B=R,F=n(102),z=n.n(F),W=n(104),V=n.n(W),I=n(103),J=n.n(I),H=n(198),N=n(187),G=n(186),U=n(199),q=n(180),K=n(179),Y=n(185),Z=function(e){Object(b.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).checkChange=a.checkChange.bind(Object(m.a)(a)),a.radioChange=a.radioChange.bind(Object(m.a)(a)),a}return Object(u.a)(n,[{key:"renderCheckboxes",value:function(e){var t=this;return e.map((function(e,n){var a=e.name.split("_"),i=a[1]+" "+a[2];return Object(k.jsx)(U.a,{label:i,value:e.name,control:Object(k.jsx)(q.a,{checked:e.visible,onChange:t.checkChange})},n)}))}},{key:"checkChange",value:function(e){var t=e.currentTarget.value,n=e.currentTarget.checked;null!==this.props.toggleElement&&this.props.toggleElement({name:t,visible:n})}},{key:"radioChange",value:function(e){null!==this.props.toggleElement&&this.props.toggleElement({name:e.target.value,visible:!0})}},{key:"renderRadioSelect",value:function(e){for(var t="",n=0;n<e.length;n++)e[n].visible&&(t=e[n].name);return Object(k.jsx)(Y.a,{"aria-labelledby":"demo-controlled-radio-buttons-group",name:"controlled-radio-buttons-group",value:t,onChange:this.radioChange,children:this.renderRadios(e)})}},{key:"renderRadios",value:function(e){return e.map((function(e,t){var n=e.name.split("_"),a=n[1]+" "+n[2];return Object(k.jsx)(U.a,{label:a,value:e.name,control:Object(k.jsx)(K.a,{})},t)}))}},{key:"render",value:function(){var e=this;return this.props.optElements.map((function(t,n){var a="opt_"+n,i=t[0].name.split("_")[1];return Object(k.jsx)(H.a,{sx:{p:1,m:1,opacity:.8},children:Object(k.jsxs)(G.a,{children:[Object(k.jsx)(N.a,{component:"legend",children:i}),1===t.length?e.renderCheckboxes(t):e.renderRadioSelect(t)]})},a)}))}}]),n}(a.Component);Z.defaultProps={optElements:[],toggleElement:null};var Q=Z,X=n(181),$=function(e){Object(b.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).animFrameLabel=a.animFrameLabel.bind(Object(m.a)(a)),a.radioChange=a.radioChange.bind(Object(m.a)(a)),a.sliderChange=a.sliderChange.bind(Object(m.a)(a)),a}return Object(u.a)(n,[{key:"sliderChange",value:function(e){var t=e.target.value,n=this.findSelected(this.props.animPoses);null!==this.props.setAnimTime&&this.props.setAnimTime(t*n.frameTime)}},{key:"findSelected",value:function(e){for(var t=0;t<e.length;t++)if(e[t].enabled)return e[t];return null}},{key:"animFrameLabel",value:function(e){return"".concat(e," frame")}},{key:"renderAnimFrames",value:function(e){var t=this.findSelected(e);if(0===t.frames)return null;var n="SELECT FRAME (".concat(t.frames," frm / ").concat(Math.round(1/t.frameTime,2),"fps)");return Object(k.jsx)(H.a,{sx:{p:1,m:1,opacity:.8},children:Object(k.jsxs)(G.a,{sx:{width:"100%"},children:[Object(k.jsx)(N.a,{component:"legend",children:n}),Object(k.jsx)(S.a,{sx:{p:1},children:Object(k.jsx)(X.a,{"aria-label":"Fames",defaultValue:0,getAriaValueText:this.animFrameLabel,valueLabelDisplay:"auto",marks:!0,min:0,max:t.frames-1,step:1,onChange:this.sliderChange})})]})})}},{key:"radioChange",value:function(e){null!==this.props.toggleAnim&&this.props.toggleAnim(e.target.value)}},{key:"renderRadioSelect",value:function(e){for(var t="",n=0;n<e.length;n++)e[n].enabled&&(t=e[n].name);return Object(k.jsx)(Y.a,{"aria-labelledby":"demo-controlled-radio-buttons-group",name:"controlled-radio-buttons-group",value:t,onChange:this.radioChange,children:this.renderRadios(e)})}},{key:"renderRadios",value:function(e){return e.map((function(e,t){return Object(k.jsx)(U.a,{label:e.name,value:e.name,control:Object(k.jsx)(K.a,{})},t)}))}},{key:"render",value:function(){var e=this.props.animPoses;return Object(k.jsxs)(i.a.Fragment,{children:[Object(k.jsx)(H.a,{sx:{p:1,m:1,opacity:.8},children:Object(k.jsxs)(G.a,{children:[Object(k.jsx)(N.a,{component:"legend",children:"SELECT POSE"}),this.renderRadioSelect(e)]})}),this.renderAnimFrames(e)]})}}]),n}(a.Component);$.defaultProps={animPoses:[],toggleAnim:null,setAnimTime:null};var ee=$,te=function(e){Object(b.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).menuSelected=a.menuSelected.bind(Object(m.a)(a)),a.state={selectedOption:""},a}return Object(u.a)(n,[{key:"menuSelected",value:function(e){var t=e.currentTarget.dataset.value;this.setState({selectedOption:t})}},{key:"renderOptionsSelector",value:function(){return"configure"!==this.state.selectedOption?null:Object(k.jsx)(Q,{optElements:this.props.optElements,toggleElement:this.props.toggleElement})}},{key:"renderAnimSelector",value:function(){return"pose"!==this.state.selectedOption?null:Object(k.jsx)(ee,{animPoses:this.props.optAnimations,toggleAnim:this.props.toggleAnimation,setAnimTime:this.props.setAnimationTime})}},{key:"renderDone",value:function(e){return e?Object(k.jsx)(T.a,{disablePadding:!0,children:Object(k.jsxs)(D.a,{onClick:this.menuSelected,"data-value":"",children:[Object(k.jsx)(P.a,{children:Object(k.jsx)(z.a,{})}),Object(k.jsx)(L.a,{primary:"DONE"})]})}):null}},{key:"renderOptions",value:function(e){return e?Object(k.jsxs)(i.a.Fragment,{children:[Object(k.jsx)(T.a,{disablePadding:!0,children:Object(k.jsxs)(D.a,{onClick:this.menuSelected,"data-value":"configure",children:[Object(k.jsx)(P.a,{children:Object(k.jsx)(J.a,{})}),Object(k.jsx)(L.a,{primary:"CONFIGURE MODEL"})]})}),Object(k.jsx)(T.a,{disablePadding:!0,children:Object(k.jsxs)(D.a,{onClick:this.menuSelected,"data-value":"pose",children:[Object(k.jsx)(P.a,{children:Object(k.jsx)(V.a,{})}),Object(k.jsx)(L.a,{primary:"SELECT POSE"})]})})]}):null}},{key:"render",value:function(){var e=""!==this.state.selectedOption;return Object(k.jsxs)(S.a,{sx:{width:.2,m:2,zIndex:"appBar",position:"absolute",top:function(e){return e.mixins.toolbar.minHeight+"px"}},children:[Object(k.jsxs)(C.a,{sx:{bgcolor:"background.paper",opacity:.8,borderRadius:1},children:[this.renderDone(e),this.renderOptions(!e)]}),this.renderOptionsSelector(),this.renderAnimSelector()]})}}]),n}(a.Component);te.defaultProps={optElements:[],toggleElement:null,optAnimations:[],toggleAnimation:null,setAnimationTime:null};var ne=te,ae=n(5),ie=n(105),re=n(106),se=n(107),oe=n(108),le=n(109),ce=function(e){Object(b.a)(n,e);var t=Object(p.a)(n);function n(e){var a;if(Object(h.a)(this,n),(a=t.call(this,e)).refRenderer=i.a.createRef(),a.save=a.save.bind(Object(m.a)(a)),a.animate=a.animate.bind(Object(m.a)(a)),a.loaderOk=a.loaderOk.bind(Object(m.a)(a)),a.loaderAnimOk=a.loaderAnimOk.bind(Object(m.a)(a)),a.loaderError=a.loaderError.bind(Object(m.a)(a)),a.loaderProgress=a.loaderProgress.bind(Object(m.a)(a)),a.toggleElement=a.toggleElement.bind(Object(m.a)(a)),a.setAnimationTime=a.setAnimationTime.bind(Object(m.a)(a)),a.onWindowResize=a.onWindowResize.bind(Object(m.a)(a)),a.animations=[],a.exporterSTL=new oe.a,a.exporterOBJ=new le.a,a.clock=new ae.i,a.animMixer=null,a.animTime=0,a.scene=new ae.ib,a.scene.background=new ae.j(11513775),a.props.showGroundPlane){var r=new ae.M(new ae.Z(2,2),new ae.O({color:8947848,depthWrite:!1}));r.rotation.x=-Math.PI/2,r.receiveShadow=!0,r.name="hlp_ground_plane",a.scene.add(r)}var s=new ae.r(16777215,4473924);s.position.set(0,20,0),a.scene.add(s),a.dirLight1=new ae.l(16777215),a.dirLight1.position.set(2,2,2),a.scene.add(a.dirLight1),a.dirLight2=new ae.l(16777215),a.dirLight2.position.set(-2,-2,-2),a.scene.add(a.dirLight2);var o=new re.a;return o.setDecoderPath(e.loadPath+"/libs/draco/"),a.loader=new ie.a,a.loader.setDRACOLoader(o),a}return Object(u.a)(n,[{key:"render",value:function(){return Object(k.jsx)(S.a,{ref:this.refRenderer,sx:{paddingTop:function(e){return e.mixins.toolbar.minHeight+"px"}}})}},{key:"save",value:function(e){console.log("Saving object");var t=this.scene.clone(),n=[];return t.traverse((function(e){e.visible||(console.log("To remove",e.name,e.id,e.uuid),n.push(e.id)),e.name.startsWith("hlp_")&&n.push(e.id)})),n.forEach((function(e){var n=t.getObjectById(e);n.parent.remove(n)})),"OBJ"===e?this.exporterOBJ.parse(t):this.exporterSTL.parse(t,{binary:!0})}},{key:"componentDidMount",value:function(){var e=this.rendererDimensions();this.camera=new ae.Y(75,e.width/e.height,.1,100),this.camera.position.y=.2,this.camera.position.z=.1,this.renderer=new ae.yb({antialias:!0}),this.renderer.setSize(e.width,e.height),this.refRenderer.current.appendChild(this.renderer.domElement),window.addEventListener("resize",this.onWindowResize),this.controls=new se.a(this.camera,this.renderer.domElement),this.controls.listenToKeyEvents(window),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.screenSpacePanning=!1,this.controls.minDistance=.22,this.controls.maxDistance=2,this.controls.maxPolarAngle=Math.PI/2,this.controls.target=new ae.wb(0,.15,0),this.controls.update(),this.animate(),null!==this.props.loadPath&&(this.props.backgroundCube.length>0&&(this.scene.background=this.loadBackgroundCube(this.props.backgroundCube)),this.loadObject(this.props.object3D))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onWindowResize)}},{key:"rendererDimensions",value:function(){var e={width:window.innerWidth,height:window.innerHeight},t=getComputedStyle(this.refRenderer.current);return e.width-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),e.height-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),e}},{key:"onWindowResize",value:function(){var e=this.rendererDimensions();this.camera.aspect=e.width/e.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(e.width,e.height)}},{key:"loadObject",value:function(e){null!==e&&this.loader.load(this.props.loadPath+e,this.loaderOk,void 0,this.loaderError)}},{key:"loadAnimation",value:function(e){null!==e&&this.loader.load(this.props.loadPath+e,this.loaderAnimOk,void 0,this.loaderError)}},{key:"loadBackgroundCube",value:function(e){if(null!==e)return(new ae.k).setPath(this.props.loadPath).load(e)}},{key:"animate",value:function(){if(requestAnimationFrame(this.animate),null!==this.animMixer)if(this.props.animSingleStep)this.animMixer.setTime(this.animTime);else{var e=this.clock.getDelta();this.animMixer.update(e/2)}this.renderer.render(this.scene,this.camera)}},{key:"loaderOk",value:function(e){console.log("Object loaded"),this.loadedObject=e.scene;var t=this.findOptional();this.defaultOptional(t);var n=new ae.O({color:2254370,flatShading:!0}),a=new ae.d;if(this.loadedObject.traverse((function(e){e.isMesh&&(e.material=n,a.expandByObject(e))})),this.props.showBoundingBox){var i=new ae.e(a,16711680);i.name="hlp_bounding_box",this.scene.add(i)}if(this.props.showSkeleton){var r=new ae.kb(this.loadedObject);r.name="hlp_skeleton",r.visible=!0,this.scene.add(r)}this.cameraToBBox(a,this.camera,this.controls,1),this.scene.add(this.loadedObject),this.animMixer=new ae.b(this.loadedObject),null!==this.props.availableElements&&this.props.availableElements(t),this.animations=[];for(var s=0;s<this.props.animPoses.length;s++)this.loadAnimation(this.props.animPoses[s])}},{key:"loaderProgress",value:function(e){console.log(e.loaded/e.total*100+"% loaded")}},{key:"loaderError",value:function(e){console.error(e)}},{key:"loaderAnimOk",value:function(e){console.log(e);var t=e.animations[0],n=0,a=0;t.tracks.forEach((function(e){e.times.length>n&&(n=e.times.length,a=e.times[0])})),this.props.animDisableMove&&(t.tracks=t.tracks.filter((function(e){return"mixamorigHips.position"!==e.name})));var i=this.animMixer.clipAction(t);if(i.enabled=!1,i.play(),this.animations.push({name:t.name,action:i,frames:n,frameTime:a}),this.props.animPoses.length===this.animations.length){var r=[];r.push({name:"None",enabled:!0,frames:0,frameTime:0});for(var s=0;s<this.animations.length;s++)r.push({name:this.animations[s].name,enabled:!1,frames:this.animations[s].frames,frameTime:this.animations[s].frameTime});null!==this.props.availableAnimations&&this.props.availableAnimations(r)}}},{key:"findOptional",value:function(){var e=[];return this.loadedObject.traverse((function(t){t.name.startsWith("opt_")&&(t.visible=!1,e.push({name:t.name,visible:!1}))})),this.groupOptional(e)}},{key:"groupOptional",value:function(e){var t=[];if(0===e.length)return t;e.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}));var n=[],a=e[0],i=a;n.push(a);for(var r=1;r<e.length;r++){a=e[r];var s=i.name.split("_"),o=a.name.split("_");s[1]!==o[1]&&(t.push(n),n=[]),n.push(a),i=a}return t.push(n),t}},{key:"defaultOptional",value:function(e){for(var t=0;t<e.length;t++)1!==e[t].length&&(e[t][0].visible=!0,this.toggleElement(e[t][0]))}},{key:"toggleElement",value:function(e){console.log("Toggle visible",e),this.loadedObject.traverse((function(t){t.name===e.name&&(t.visible=e.visible)}))}},{key:"toggleAnimation",value:function(e){console.log("Toggle animation",e);for(var t=0;t<this.animations.length;t++)this.animations[t].action.enabled=this.animations[t].name===e;this.animTime=0}},{key:"setAnimationTime",value:function(e){this.animTime=e}},{key:"cameraToBBox",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.2,i=new ae.wb,r=new ae.wb;e.getSize(i),e.getCenter(r);var s=Math.max(i.x,i.y,i.z),o=s/(2*Math.atan(Math.PI*t.fov/360)),l=o/t.aspect,c=a*Math.max(o,l),d=n.target.clone().sub(t.position).normalize().multiplyScalar(c);n.maxDistance=10*c,n.target.copy(r),t.near=c/100,t.far=100*c,t.updateProjectionMatrix(),t.position.copy(n.target).sub(d),n.update()}}]),n}(a.Component);ce.defaultProps={loadPath:null,object3D:null,animPoses:null,showBoundingBox:!1,showSkeleton:!1,showGroundPlane:!0,backgroundCube:null,availableElements:null,availableAnimations:null,animSingleStep:!0,animDisableMove:!0};var de=ce,he=n(91),ue=function(e){Object(b.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).state={elements:[],animations:[]},a.refDrawerMenu=i.a.createRef(),a.refView3D=i.a.createRef(),a.toggleDrawer=a.toggleDrawer.bind(Object(m.a)(a)),a.save=a.save.bind(Object(m.a)(a)),a.availableElements=a.availableElements.bind(Object(m.a)(a)),a.toggleElement=a.toggleElement.bind(Object(m.a)(a)),a.availableAnimations=a.availableAnimations.bind(Object(m.a)(a)),a.toggleAnimation=a.toggleAnimation.bind(Object(m.a)(a)),a.setAnimationTime=a.setAnimationTime.bind(Object(m.a)(a)),a}return Object(u.a)(n,[{key:"toggleDrawer",value:function(e){this.refDrawerMenu.current.toggleDrawer(e)}},{key:"save",value:function(e){var t=this.refView3D.current.save(e);switch(e){case"STL":var n=new Blob([t],{type:"application/octet-stream"});Object(he.saveAs)(n,"for-print.stl");break;case"OBJ":var a=new Blob([t],{type:"text/plain"});Object(he.saveAs)(a,"for-print.obj");break;default:console.log("Unsupported file format ->",e)}}},{key:"availableElements",value:function(e){this.setState({elements:e})}},{key:"toggleElement",value:function(e){var t=this,n=e.name.split("_"),a=this.state.elements.map((function(a){var i=a[0].name.split("_");if(n[1]!==i[1])return a;var r=a.length>1;return a.map((function(n){return n.name===e.name?(n.visible=e.visible,t.refView3D.current.toggleElement(n)):r&&(n.visible=!e.visible,t.refView3D.current.toggleElement(n)),n}))}));this.setState({elements:a})}},{key:"availableAnimations",value:function(e){this.setState({animations:e})}},{key:"toggleAnimation",value:function(e){var t=this.state.animations.map((function(t){return t.enabled=t.name===e,t}));this.refView3D.current.toggleAnimation(e),this.setState({animations:t})}},{key:"setAnimationTime",value:function(e){this.refView3D.current.setAnimationTime(e)}},{key:"render",value:function(){return Object(k.jsxs)(i.a.Fragment,{children:[Object(k.jsx)(y,{toggleDrawer:this.toggleDrawer}),Object(k.jsx)(B,{ref:this.refDrawerMenu,save:this.save}),Object(k.jsx)(de,{ref:this.refView3D,loadPath:"/3dprint-demo",object3D:"/objects/rhodesia-solider.glb",backgroundCube:[],animPoses:["/anims/fire_rifle.gltf","/anims/hit_reaction.gltf","/anims/reloading.gltf","/anims/rifle_aiming.gltf","/anims/rifle_jump.gltf","/anims/rifle_run.gltf","/anims/run_backwards.gltf","/anims/starfe_left.gltf","/anims/starfe_right.gltf","/anims/toss_grenade.gltf","/anims/turn_left.gltf","/anims/turn_right.gltf","/anims/walking_backwards.gltf","/anims/walking.gltf"],availableElements:this.availableElements,availableAnimations:this.availableAnimations}),Object(k.jsx)(ne,{optElements:this.state.elements,toggleElement:this.toggleElement,optAnimations:this.state.animations,toggleAnimation:this.toggleAnimation,setAnimationTime:this.setAnimationTime})]})}}]),n}(a.Component),me=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,200)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),i(e),r(e),s(e)}))};s.a.render(Object(k.jsx)(i.a.StrictMode,{children:Object(k.jsxs)(l.a,{theme:d,children:[Object(k.jsx)(o.a,{enableColorScheme:!0}),Object(k.jsx)(ue,{})]})}),document.getElementById("root")),me()}},[[138,1,2]]]);
//# sourceMappingURL=main.2378303c.chunk.js.map