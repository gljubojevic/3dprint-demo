(this["webpackJsonp3dprint-demo"]=this["webpackJsonp3dprint-demo"]||[]).push([[0],{115:function(e,t,n){},125:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(39),o=n.n(i),s=(n(115),n(178)),l=n(174),c=n(102),h=Object(c.a)({}),d=n(1),u=n(2),p=n(20),b=n(5),g=n(6),v=n(179),j=n(181),m=n(183),f=n(182),O=n(95),w=n.n(O),x=n(3),k=function(e){Object(b.a)(n,e);var t=Object(g.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(x.jsx)(v.a,{position:"fixed",children:Object(x.jsxs)(j.a,{variant:"regular",children:[Object(x.jsx)(f.a,{edge:"start",color:"inherit","aria-label":"menu",onClick:this.props.toggleDrawer,children:Object(x.jsx)(w.a,{})}),Object(x.jsx)(m.a,{variant:"h6",color:"inherit",children:"3D Print demo"})]})})}}]),n}(a.Component);k.defaultProps={toggleDrawer:null};var y=k,E=n(185),D=n(169),S=n(184),C=n(186),B=n(173),P=n(167),R=n(187),T=n(188),L=n(82),M=n.n(L),z=function(e){Object(b.a)(n,e);var t=Object(g.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).toggleDrawer=a.toggleDrawer.bind(Object(p.a)(a)),a.save=a.save.bind(Object(p.a)(a)),a.state={isOpen:!1},a}return Object(u.a)(n,[{key:"toggleDrawer",value:function(e){("keydown"!==e.type||"Tab"!==e.key&&"Shift"!==e.key)&&this.setState({isOpen:!this.state.isOpen})}},{key:"save",value:function(e){if(null!==this.props.save){var t=e.currentTarget.dataset.value;t||(t="STL"),this.setState({isOpen:!1}),this.props.save(t)}else console.error("No save handler set")}},{key:"render",value:function(){return Object(x.jsx)(D.a,{anchor:"left",open:this.state.isOpen,onClose:this.toggleDrawer,children:Object(x.jsxs)(S.a,{p:1,children:[Object(x.jsx)(m.a,{variant:"h4",component:"h4",children:"Main menu"}),Object(x.jsx)(E.a,{}),Object(x.jsxs)(C.a,{component:"nav","aria-label":"main selector",children:[Object(x.jsx)(B.a,{children:Object(x.jsxs)(P.a,{onClick:this.save,"data-value":"STL",children:[Object(x.jsx)(R.a,{children:Object(x.jsx)(M.a,{})}),Object(x.jsx)(T.a,{primary:"Save STL for print"})]})}),Object(x.jsx)(B.a,{children:Object(x.jsxs)(P.a,{onClick:this.save,"data-value":"OBJ",children:[Object(x.jsx)(R.a,{children:Object(x.jsx)(M.a,{})}),Object(x.jsx)(T.a,{primary:"Save OBJ for print"})]})})]})]})})}}]),n}(a.Component);z.defaultProps={save:null};var _=z,F=n(180),W=n(177),J=n(176),I=n(189),A=n(171),V=n(170),H=n(175),G=function(e){Object(b.a)(n,e);var t=Object(g.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).checkChange=a.checkChange.bind(Object(p.a)(a)),a.radioChange=a.radioChange.bind(Object(p.a)(a)),a}return Object(u.a)(n,[{key:"renderCheckboxes",value:function(e){var t=this;return e.map((function(e,n){var a=e.name.split("_"),r=a[1]+" "+a[2];return Object(x.jsx)(I.a,{label:r,value:e.name,control:Object(x.jsx)(A.a,{checked:e.visible,onChange:t.checkChange})},n)}))}},{key:"checkChange",value:function(e){var t=e.currentTarget.value,n=e.currentTarget.checked;null!==this.props.toggleElement&&this.props.toggleElement({name:t,visible:n})}},{key:"radioChange",value:function(e){null!==this.props.toggleElement&&this.props.toggleElement({name:e.target.value,visible:!0})}},{key:"renderRadioSelect",value:function(e){for(var t="",n=0;n<e.length;n++)e[n].visible&&(t=e[n].name);return Object(x.jsx)(H.a,{"aria-labelledby":"demo-controlled-radio-buttons-group",name:"controlled-radio-buttons-group",value:t,onChange:this.radioChange,children:this.renderRadios(e)})}},{key:"renderRadios",value:function(e){return e.map((function(e,t){var n=e.name.split("_"),a=n[1]+" "+n[2];return Object(x.jsx)(I.a,{label:a,value:e.name,control:Object(x.jsx)(V.a,{})},t)}))}},{key:"renderSelectors",value:function(e){var t=this;return e.map((function(e,n){var a="opt_"+n,r=e[0].name.split("_")[1];return Object(x.jsx)(F.a,{sx:{p:1,m:1,opacity:.8},children:Object(x.jsxs)(J.a,{children:[Object(x.jsx)(W.a,{component:"legend",children:r}),1===e.length?t.renderCheckboxes(e):t.renderRadioSelect(e)]})},a)}))}},{key:"render",value:function(){return Object(x.jsx)(S.a,{sx:{width:.2,m:2,zIndex:"appBar",position:"absolute",top:function(e){return e.mixins.toolbar.minHeight+"px"}},children:this.renderSelectors(this.props.optElements)})}}]),n}(a.Component);G.defaultProps={optElements:[],toggleElement:null};var K=G,U=n(4),q=n(97),N=n(98),X=n(99),Q=n(100),Y=n(101),Z=function(e){Object(b.a)(n,e);var t=Object(g.a)(n);function n(e){var a;if(Object(d.a)(this,n),(a=t.call(this,e)).refRenderer=r.a.createRef(),a.save=a.save.bind(Object(p.a)(a)),a.animate=a.animate.bind(Object(p.a)(a)),a.loaderOk=a.loaderOk.bind(Object(p.a)(a)),a.loaderError=a.loaderError.bind(Object(p.a)(a)),a.loaderProgress=a.loaderProgress.bind(Object(p.a)(a)),a.toggleElement=a.toggleElement.bind(Object(p.a)(a)),a.onWindowResize=a.onWindowResize.bind(Object(p.a)(a)),a.exporterSTL=new Q.a,a.exporterOBJ=new Y.a,a.scene=new U.gb,a.scene.background=new U.h(11513775),a.props.showGroundPlane){var i=new U.K(new U.X(2,2),new U.M({color:8947848,depthWrite:!1}));i.rotation.x=-Math.PI/2,i.receiveShadow=!0,i.name="hlp_ground_plane",a.scene.add(i)}var o=new U.p(16777215,4473924);o.position.set(0,20,0),a.scene.add(o),a.dirLight1=new U.j(16777215),a.dirLight1.position.set(2,2,2),a.scene.add(a.dirLight1),a.dirLight2=new U.j(16777215),a.dirLight2.position.set(-2,-2,-2),a.scene.add(a.dirLight2);var s=new N.a;return s.setDecoderPath(e.loadPath+"/libs/draco/"),a.loader=new q.a,a.loader.setDRACOLoader(s),a}return Object(u.a)(n,[{key:"render",value:function(){return Object(x.jsx)(S.a,{ref:this.refRenderer,sx:{paddingTop:function(e){return e.mixins.toolbar.minHeight+"px"}}})}},{key:"save",value:function(e){console.log("Saving object");var t=this.scene.clone(),n=[];switch(t.traverse((function(e){e.visible||(console.log("To remove",e.name,e.id,e.uuid),n.push(e.id)),e.name.startsWith("hlp_")&&n.push(e.id)})),n.forEach((function(e){var n=t.getObjectById(e);n.parent.remove(n)})),e){case"STL":return this.exporterSTL.parse(t,{binary:!0});case"OBJ":return this.exporterOBJ.parse(t)}return this.exporterSTL.parse(t,{binary:!0})}},{key:"componentDidMount",value:function(){var e=this.rendererDimensions();this.camera=new U.W(75,e.width/e.height,.1,100),this.camera.position.y=.2,this.camera.position.z=.1,this.renderer=new U.wb({antialias:!0}),this.renderer.setSize(e.width,e.height),this.refRenderer.current.appendChild(this.renderer.domElement),window.addEventListener("resize",this.onWindowResize),this.controls=new X.a(this.camera,this.renderer.domElement),this.controls.listenToKeyEvents(window),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.screenSpacePanning=!1,this.controls.minDistance=.22,this.controls.maxDistance=2,this.controls.maxPolarAngle=Math.PI/2,this.controls.target=new U.ub(0,.15,0),this.controls.update(),this.animate(),null!==this.props.loadPath&&this.loadObject(this.props.object3D)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onWindowResize)}},{key:"rendererDimensions",value:function(){var e={width:window.innerWidth,height:window.innerHeight},t=getComputedStyle(this.refRenderer.current);return e.width-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),e.height-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),e}},{key:"onWindowResize",value:function(){var e=this.rendererDimensions();this.camera.aspect=e.width/e.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(e.width,e.height)}},{key:"loadObject",value:function(e){null!==e&&this.loader.load(this.props.loadPath+e,this.loaderOk,void 0,this.loaderError)}},{key:"loadBackgroundCube",value:function(e){if(null!==e)return(new U.i).setPath(this.props.loadPath).load(e)}},{key:"animate",value:function(){requestAnimationFrame(this.animate),this.renderer.render(this.scene,this.camera)}},{key:"loaderOk",value:function(e){console.log("Object loaded"),this.loadedObject=e.scene;var t=[];this.findOptional(t,this.loadedObject.children);var n=this.groupOptional(t);this.defaultOptional(n);var a=new U.M({color:2254370,flatShading:!0}),r=new U.c;if(this.loadedObject.traverse((function(e){e.isMesh&&(e.material=a,r.expandByObject(e))})),this.props.showBoundingBox){var i=new U.d(r,16711680);i.name="hlp_bounding_box",this.scene.add(i)}if(this.props.showSkeleton){var o=new U.ib(this.loadedObject);o.name="hlp_skeleton",o.visible=!0,this.scene.add(o)}this.cameraToBBox(r,this.camera,this.controls,1),this.scene.add(this.loadedObject),null!==this.props.availableElements&&this.props.availableElements(n)}},{key:"loaderProgress",value:function(e){console.log(e.loaded/e.total*100+"% loaded")}},{key:"loaderError",value:function(e){console.error(e)}},{key:"findOptional",value:function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.children.length>0&&this.findOptional(e,a.children),a.name.startsWith("opt_")&&(a.visible=!1,e.push({name:a.name,visible:!1}))}}},{key:"groupOptional",value:function(e){var t=[];if(0===e.length)return t;e.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}));var n=[],a=e[0],r=a;n.push(a);for(var i=1;i<e.length;i++){a=e[i];var o=r.name.split("_"),s=a.name.split("_");o[1]!==s[1]&&(t.push(n),n=[]),n.push(a),r=a}return t.push(n),t}},{key:"defaultOptional",value:function(e){for(var t=0;t<e.length;t++)1!==e[t].length&&(e[t][0].visible=!0,this.toggleElement(e[t][0]))}},{key:"toggleElement",value:function(e){console.log("Toggle visible",e),this.toggleElementRecursive(e,this.loadedObject)}},{key:"toggleElementRecursive",value:function(e,t){if(t.name!==e.name)for(var n=0;n<t.children.length;n++)t.children[n].name===e.name&&(t.children[n].visible=e.visible),0<t.children[n].children.length&&this.toggleElementRecursive(e,t.children[n]);else t.visible=e.visible}},{key:"cameraToBBox",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.2,r=new U.ub,i=new U.ub;e.getSize(r),e.getCenter(i);var o=Math.max(r.x,r.y,r.z),s=o/(2*Math.atan(Math.PI*t.fov/360)),l=s/t.aspect,c=a*Math.max(s,l),h=n.target.clone().sub(t.position).normalize().multiplyScalar(c);n.maxDistance=10*c,n.target.copy(i),t.near=c/100,t.far=100*c,t.updateProjectionMatrix(),t.position.copy(n.target).sub(h),n.update()}}]),n}(a.Component);Z.defaultProps={loadPath:null,object3D:null,showBoundingBox:!1,showSkeleton:!1,showGroundPlane:!0,backgroundCube:null,availableElements:null};var $=Z,ee=n(83),te=function(e){Object(b.a)(n,e);var t=Object(g.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).state={elements:[]},a.refDrawerMenu=r.a.createRef(),a.refView3D=r.a.createRef(),a.toggleDrawer=a.toggleDrawer.bind(Object(p.a)(a)),a.save=a.save.bind(Object(p.a)(a)),a.availableElements=a.availableElements.bind(Object(p.a)(a)),a.toggleElement=a.toggleElement.bind(Object(p.a)(a)),a}return Object(u.a)(n,[{key:"toggleDrawer",value:function(e){this.refDrawerMenu.current.toggleDrawer(e)}},{key:"save",value:function(e){var t=this.refView3D.current.save(e);switch(e){case"STL":var n=new Blob([t],{type:"application/octet-stream"});Object(ee.saveAs)(n,"for-print.stl");break;case"OBJ":var a=new Blob([t],{type:"text/plain"});Object(ee.saveAs)(a,"for-print.obj");break;default:console.log("Unsupported file format ->",e)}}},{key:"availableElements",value:function(e){this.setState({elements:e})}},{key:"toggleElement",value:function(e){var t=this,n=e.name.split("_"),a=this.state.elements.map((function(a){var r=a[0].name.split("_");if(n[1]!==r[1])return a;var i=a.length>1;return a.map((function(n){return n.name===e.name?(n.visible=e.visible,t.refView3D.current.toggleElement(n)):i&&(n.visible=!e.visible,t.refView3D.current.toggleElement(n)),n}))}));this.setState({elements:a})}},{key:"render",value:function(){return Object(x.jsxs)(r.a.Fragment,{children:[Object(x.jsx)(y,{toggleDrawer:this.toggleDrawer}),Object(x.jsx)(_,{ref:this.refDrawerMenu,save:this.save}),Object(x.jsx)($,{ref:this.refView3D,loadPath:"/3dprint-demo",object3D:"/objects/rhodesia-solider.glb",backgroundCube:["/textures/Brudslojan/posx.jpg","/textures/Brudslojan/negx.jpg","/textures/Brudslojan/posy.jpg","/textures/Brudslojan/negy.jpg","/textures/Brudslojan/posz.jpg","/textures/Brudslojan/negz.jpg"],availableElements:this.availableElements}),Object(x.jsx)(K,{optElements:this.state.elements,toggleElement:this.toggleElement})]})}}]),n}(a.Component),ne=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,190)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),i(e),o(e)}))};o.a.render(Object(x.jsx)(r.a.StrictMode,{children:Object(x.jsxs)(l.a,{theme:h,children:[Object(x.jsx)(s.a,{enableColorScheme:!0}),Object(x.jsx)(te,{})]})}),document.getElementById("root")),ne()}},[[125,1,2]]]);
//# sourceMappingURL=main.cc287c8e.chunk.js.map