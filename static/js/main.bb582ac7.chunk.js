(this["webpackJsonp3dprint-demo"]=this["webpackJsonp3dprint-demo"]||[]).push([[0],{126:function(e,t,n){},136:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(39),o=n.n(r),s=(n(126),n(181)),l=n(177),c=n(107),d=Object(c.a)({}),h=n(1),u=n(3),m=n(16),b=n(5),p=n(6),g=n(182),j=n(183),v=n(185),O=n(184),f=n(97),x=n.n(f),k=n(2),w=function(e){Object(b.a)(n,e);var t=Object(p.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(k.jsx)(g.a,{position:"fixed",children:Object(k.jsxs)(j.a,{variant:"regular",children:[Object(k.jsx)(O.a,{edge:"start",color:"inherit","aria-label":"menu",onClick:this.props.toggleDrawer,children:Object(k.jsx)(x.a,{})}),Object(k.jsx)(v.a,{variant:"h6",color:"inherit",children:"3D Print demo"})]})})}}]),n}(a.Component);w.defaultProps={toggleDrawer:null};var y=w,E=n(187),S=n(172),C=n(186),P=n(188),D=n(176),A=n(170),B=n(189),_=n(190),T=n(85),R=n.n(T),L=function(e){Object(b.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).toggleDrawer=a.toggleDrawer.bind(Object(m.a)(a)),a.save=a.save.bind(Object(m.a)(a)),a.state={isOpen:!1},a}return Object(u.a)(n,[{key:"toggleDrawer",value:function(e){("keydown"!==e.type||"Tab"!==e.key&&"Shift"!==e.key)&&this.setState({isOpen:!this.state.isOpen})}},{key:"save",value:function(e){if(null!==this.props.save){var t=e.currentTarget.dataset.value;t||(t="STL"),this.setState({isOpen:!1}),this.props.save(t)}else console.error("No save handler set")}},{key:"render",value:function(){return Object(k.jsx)(S.a,{anchor:"left",open:this.state.isOpen,onClose:this.toggleDrawer,children:Object(k.jsxs)(C.a,{p:1,children:[Object(k.jsx)(v.a,{variant:"h4",component:"h4",children:"Main menu"}),Object(k.jsx)(E.a,{}),Object(k.jsxs)(P.a,{component:"nav","aria-label":"main selector",children:[Object(k.jsx)(D.a,{children:Object(k.jsxs)(A.a,{onClick:this.save,"data-value":"STL",children:[Object(k.jsx)(B.a,{children:Object(k.jsx)(R.a,{})}),Object(k.jsx)(_.a,{primary:"Save STL for print"})]})}),Object(k.jsx)(D.a,{children:Object(k.jsxs)(A.a,{onClick:this.save,"data-value":"OBJ",children:[Object(k.jsx)(B.a,{children:Object(k.jsx)(R.a,{})}),Object(k.jsx)(_.a,{primary:"Save OBJ for print"})]})})]})]})})}}]),n}(a.Component);L.defaultProps={save:null};var M=L,z=n(99),F=n.n(z),W=n(101),I=n.n(W),J=n(100),V=n.n(J),N=n(191),G=n(180),H=n(179),U=n(192),q=n(174),K=n(173),Y=n(178),Z=function(e){Object(b.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).checkChange=a.checkChange.bind(Object(m.a)(a)),a.radioChange=a.radioChange.bind(Object(m.a)(a)),a}return Object(u.a)(n,[{key:"renderCheckboxes",value:function(e){var t=this;return e.map((function(e,n){var a=e.name.split("_"),i=a[1]+" "+a[2];return Object(k.jsx)(U.a,{label:i,value:e.name,control:Object(k.jsx)(q.a,{checked:e.visible,onChange:t.checkChange})},n)}))}},{key:"checkChange",value:function(e){var t=e.currentTarget.value,n=e.currentTarget.checked;null!==this.props.toggleElement&&this.props.toggleElement({name:t,visible:n})}},{key:"radioChange",value:function(e){null!==this.props.toggleElement&&this.props.toggleElement({name:e.target.value,visible:!0})}},{key:"renderRadioSelect",value:function(e){for(var t="",n=0;n<e.length;n++)e[n].visible&&(t=e[n].name);return Object(k.jsx)(Y.a,{"aria-labelledby":"demo-controlled-radio-buttons-group",name:"controlled-radio-buttons-group",value:t,onChange:this.radioChange,children:this.renderRadios(e)})}},{key:"renderRadios",value:function(e){return e.map((function(e,t){var n=e.name.split("_"),a=n[1]+" "+n[2];return Object(k.jsx)(U.a,{label:a,value:e.name,control:Object(k.jsx)(K.a,{})},t)}))}},{key:"render",value:function(){var e=this;return this.props.optElements.map((function(t,n){var a="opt_"+n,i=t[0].name.split("_")[1];return Object(k.jsx)(N.a,{sx:{p:1,m:1,opacity:.8},children:Object(k.jsxs)(H.a,{children:[Object(k.jsx)(G.a,{component:"legend",children:i}),1===t.length?e.renderCheckboxes(t):e.renderRadioSelect(t)]})},a)}))}}]),n}(a.Component);Z.defaultProps={optElements:[],toggleElement:null};var Q=Z,X=function(e){Object(b.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).radioChange=a.radioChange.bind(Object(m.a)(a)),a}return Object(u.a)(n,[{key:"radioChange",value:function(e){null!==this.props.toggleAnim&&this.props.toggleAnim(e.target.value)}},{key:"renderRadioSelect",value:function(e){for(var t="",n=0;n<e.length;n++)e[n].enabled&&(t=e[n].name);return Object(k.jsx)(Y.a,{"aria-labelledby":"demo-controlled-radio-buttons-group",name:"controlled-radio-buttons-group",value:t,onChange:this.radioChange,children:this.renderRadios(e)})}},{key:"renderRadios",value:function(e){return e.map((function(e,t){return Object(k.jsx)(U.a,{label:e.name,value:e.name,control:Object(k.jsx)(K.a,{})},t)}))}},{key:"render",value:function(){return Object(k.jsx)(N.a,{sx:{p:1,m:1,opacity:.8},children:Object(k.jsxs)(H.a,{children:[Object(k.jsx)(G.a,{component:"legend",children:"SELECT POSE"}),this.renderRadioSelect(this.props.animPoses)]})})}}]),n}(a.Component);X.defaultProps={animPoses:[],toggleAnim:null};var $=X,ee=function(e){Object(b.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).menuSelected=a.menuSelected.bind(Object(m.a)(a)),a.state={selectedOption:""},a}return Object(u.a)(n,[{key:"menuSelected",value:function(e){var t=e.currentTarget.dataset.value;this.setState({selectedOption:t})}},{key:"renderOptionsSelector",value:function(){return"configure"!==this.state.selectedOption?null:Object(k.jsx)(Q,{optElements:this.props.optElements,toggleElement:this.props.toggleElement})}},{key:"renderAnimSelector",value:function(){return"pose"!==this.state.selectedOption?null:Object(k.jsx)($,{animPoses:this.props.optAnimations,toggleAnim:this.props.toggleAnimation})}},{key:"renderDone",value:function(e){return e?Object(k.jsx)(D.a,{disablePadding:!0,children:Object(k.jsxs)(A.a,{onClick:this.menuSelected,"data-value":"",children:[Object(k.jsx)(B.a,{children:Object(k.jsx)(F.a,{})}),Object(k.jsx)(_.a,{primary:"DONE"})]})}):null}},{key:"renderOptions",value:function(e){return e?Object(k.jsxs)(i.a.Fragment,{children:[Object(k.jsx)(D.a,{disablePadding:!0,children:Object(k.jsxs)(A.a,{onClick:this.menuSelected,"data-value":"configure",children:[Object(k.jsx)(B.a,{children:Object(k.jsx)(V.a,{})}),Object(k.jsx)(_.a,{primary:"CONFIGURE MODEL"})]})}),Object(k.jsx)(D.a,{disablePadding:!0,children:Object(k.jsxs)(A.a,{onClick:this.menuSelected,"data-value":"pose",children:[Object(k.jsx)(B.a,{children:Object(k.jsx)(I.a,{})}),Object(k.jsx)(_.a,{primary:"SELECT POSE"})]})})]}):null}},{key:"render",value:function(){var e=""!==this.state.selectedOption;return Object(k.jsxs)(C.a,{sx:{width:.2,m:2,zIndex:"appBar",position:"absolute",top:function(e){return e.mixins.toolbar.minHeight+"px"}},children:[Object(k.jsxs)(P.a,{sx:{bgcolor:"background.paper",opacity:.8,borderRadius:1},children:[this.renderDone(e),this.renderOptions(!e)]}),this.renderOptionsSelector(),this.renderAnimSelector()]})}}]),n}(a.Component);ee.defaultProps={optElements:[],toggleElement:null,optAnimations:[],toggleAnimation:null};var te=ee,ne=n(4),ae=n(102),ie=n(103),re=n(104),oe=n(105),se=n(106),le=function(e){Object(b.a)(n,e);var t=Object(p.a)(n);function n(e){var a;if(Object(h.a)(this,n),(a=t.call(this,e)).refRenderer=i.a.createRef(),a.save=a.save.bind(Object(m.a)(a)),a.animate=a.animate.bind(Object(m.a)(a)),a.loaderOk=a.loaderOk.bind(Object(m.a)(a)),a.loaderAnimOk=a.loaderAnimOk.bind(Object(m.a)(a)),a.loaderError=a.loaderError.bind(Object(m.a)(a)),a.loaderProgress=a.loaderProgress.bind(Object(m.a)(a)),a.toggleElement=a.toggleElement.bind(Object(m.a)(a)),a.onWindowResize=a.onWindowResize.bind(Object(m.a)(a)),a.animations=[],a.exporterSTL=new oe.a,a.exporterOBJ=new se.a,a.clock=new ne.i,a.animMixer=null,a.scene=new ne.ib,a.scene.background=new ne.j(11513775),a.props.showGroundPlane){var r=new ne.M(new ne.Z(2,2),new ne.O({color:8947848,depthWrite:!1}));r.rotation.x=-Math.PI/2,r.receiveShadow=!0,r.name="hlp_ground_plane",a.scene.add(r)}var o=new ne.r(16777215,4473924);o.position.set(0,20,0),a.scene.add(o),a.dirLight1=new ne.l(16777215),a.dirLight1.position.set(2,2,2),a.scene.add(a.dirLight1),a.dirLight2=new ne.l(16777215),a.dirLight2.position.set(-2,-2,-2),a.scene.add(a.dirLight2);var s=new ie.a;return s.setDecoderPath(e.loadPath+"/libs/draco/"),a.loader=new ae.a,a.loader.setDRACOLoader(s),a}return Object(u.a)(n,[{key:"render",value:function(){return Object(k.jsx)(C.a,{ref:this.refRenderer,sx:{paddingTop:function(e){return e.mixins.toolbar.minHeight+"px"}}})}},{key:"save",value:function(e){console.log("Saving object");var t=this.scene.clone(),n=[];switch(t.traverse((function(e){e.visible||(console.log("To remove",e.name,e.id,e.uuid),n.push(e.id)),e.name.startsWith("hlp_")&&n.push(e.id)})),n.forEach((function(e){var n=t.getObjectById(e);n.parent.remove(n)})),e){case"STL":return this.exporterSTL.parse(t,{binary:!0});case"OBJ":return this.exporterOBJ.parse(t)}return this.exporterSTL.parse(t,{binary:!0})}},{key:"componentDidMount",value:function(){var e=this.rendererDimensions();this.camera=new ne.Y(75,e.width/e.height,.1,100),this.camera.position.y=.2,this.camera.position.z=.1,this.renderer=new ne.yb({antialias:!0}),this.renderer.setSize(e.width,e.height),this.refRenderer.current.appendChild(this.renderer.domElement),window.addEventListener("resize",this.onWindowResize),this.controls=new re.a(this.camera,this.renderer.domElement),this.controls.listenToKeyEvents(window),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.screenSpacePanning=!1,this.controls.minDistance=.22,this.controls.maxDistance=2,this.controls.maxPolarAngle=Math.PI/2,this.controls.target=new ne.wb(0,.15,0),this.controls.update(),this.animate(),null!==this.props.loadPath&&this.loadObject(this.props.object3D)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onWindowResize)}},{key:"rendererDimensions",value:function(){var e={width:window.innerWidth,height:window.innerHeight},t=getComputedStyle(this.refRenderer.current);return e.width-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),e.height-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),e}},{key:"onWindowResize",value:function(){var e=this.rendererDimensions();this.camera.aspect=e.width/e.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(e.width,e.height)}},{key:"loadObject",value:function(e){null!==e&&this.loader.load(this.props.loadPath+e,this.loaderOk,void 0,this.loaderError)}},{key:"loadAnimation",value:function(e){null!==e&&this.loader.load(this.props.loadPath+e,this.loaderAnimOk,void 0,this.loaderError)}},{key:"loadBackgroundCube",value:function(e){if(null!==e)return(new ne.k).setPath(this.props.loadPath).load(e)}},{key:"animate",value:function(){if(requestAnimationFrame(this.animate),null!==this.animMixer){var e=this.clock.getDelta();this.animMixer.update(e/2)}this.renderer.render(this.scene,this.camera)}},{key:"loaderOk",value:function(e){console.log("Object loaded"),this.loadedObject=e.scene;var t=this.findOptional();this.defaultOptional(t);var n=new ne.O({color:2254370,flatShading:!0}),a=new ne.d;if(this.loadedObject.traverse((function(e){e.isMesh&&(e.material=n,a.expandByObject(e))})),this.props.showBoundingBox){var i=new ne.e(a,16711680);i.name="hlp_bounding_box",this.scene.add(i)}if(this.props.showSkeleton){var r=new ne.kb(this.loadedObject);r.name="hlp_skeleton",r.visible=!0,this.scene.add(r)}this.cameraToBBox(a,this.camera,this.controls,1),this.scene.add(this.loadedObject),this.animMixer=new ne.b(this.loadedObject),null!==this.props.availableElements&&this.props.availableElements(t),this.animations=[];for(var o=0;o<this.props.animPoses.length;o++)this.loadAnimation(this.props.animPoses[o])}},{key:"loaderProgress",value:function(e){console.log(e.loaded/e.total*100+"% loaded")}},{key:"loaderError",value:function(e){console.error(e)}},{key:"loaderAnimOk",value:function(e){var t=e.animations[0],n=this.animMixer.clipAction(t);if(n.enabled=!1,n.play(),this.animations.push({name:t.name,action:n}),this.props.animPoses.length===this.animations.length){var a=[];a.push({name:"None",enabled:!0});for(var i=0;i<this.animations.length;i++)a.push({name:this.animations[i].name,enabled:!1});null!==this.props.availableAnimations&&this.props.availableAnimations(a)}}},{key:"findOptional",value:function(){var e=[];return this.loadedObject.traverse((function(t){t.name.startsWith("opt_")&&(t.visible=!1,e.push({name:t.name,visible:!1}))})),this.groupOptional(e)}},{key:"groupOptional",value:function(e){var t=[];if(0===e.length)return t;e.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}));var n=[],a=e[0],i=a;n.push(a);for(var r=1;r<e.length;r++){a=e[r];var o=i.name.split("_"),s=a.name.split("_");o[1]!==s[1]&&(t.push(n),n=[]),n.push(a),i=a}return t.push(n),t}},{key:"defaultOptional",value:function(e){for(var t=0;t<e.length;t++)1!==e[t].length&&(e[t][0].visible=!0,this.toggleElement(e[t][0]))}},{key:"toggleElement",value:function(e){console.log("Toggle visible",e),this.loadedObject.traverse((function(t){t.name===e.name&&(t.visible=e.visible)}))}},{key:"toggleAnimation",value:function(e){console.log("Toggle animation",e);for(var t=0;t<this.animations.length;t++)this.animations[t].action.enabled=this.animations[t].name===e}},{key:"cameraToBBox",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.2,i=new ne.wb,r=new ne.wb;e.getSize(i),e.getCenter(r);var o=Math.max(i.x,i.y,i.z),s=o/(2*Math.atan(Math.PI*t.fov/360)),l=s/t.aspect,c=a*Math.max(s,l),d=n.target.clone().sub(t.position).normalize().multiplyScalar(c);n.maxDistance=10*c,n.target.copy(r),t.near=c/100,t.far=100*c,t.updateProjectionMatrix(),t.position.copy(n.target).sub(d),n.update()}}]),n}(a.Component);le.defaultProps={loadPath:null,object3D:null,animPoses:null,showBoundingBox:!1,showSkeleton:!1,showGroundPlane:!0,backgroundCube:null,availableElements:null,availableAnimations:null};var ce=le,de=n(86),he=function(e){Object(b.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).state={elements:[],animations:[]},a.refDrawerMenu=i.a.createRef(),a.refView3D=i.a.createRef(),a.toggleDrawer=a.toggleDrawer.bind(Object(m.a)(a)),a.save=a.save.bind(Object(m.a)(a)),a.availableElements=a.availableElements.bind(Object(m.a)(a)),a.toggleElement=a.toggleElement.bind(Object(m.a)(a)),a.availableAnimations=a.availableAnimations.bind(Object(m.a)(a)),a.toggleAnimation=a.toggleAnimation.bind(Object(m.a)(a)),a}return Object(u.a)(n,[{key:"toggleDrawer",value:function(e){this.refDrawerMenu.current.toggleDrawer(e)}},{key:"save",value:function(e){var t=this.refView3D.current.save(e);switch(e){case"STL":var n=new Blob([t],{type:"application/octet-stream"});Object(de.saveAs)(n,"for-print.stl");break;case"OBJ":var a=new Blob([t],{type:"text/plain"});Object(de.saveAs)(a,"for-print.obj");break;default:console.log("Unsupported file format ->",e)}}},{key:"availableElements",value:function(e){this.setState({elements:e})}},{key:"toggleElement",value:function(e){var t=this,n=e.name.split("_"),a=this.state.elements.map((function(a){var i=a[0].name.split("_");if(n[1]!==i[1])return a;var r=a.length>1;return a.map((function(n){return n.name===e.name?(n.visible=e.visible,t.refView3D.current.toggleElement(n)):r&&(n.visible=!e.visible,t.refView3D.current.toggleElement(n)),n}))}));this.setState({elements:a})}},{key:"availableAnimations",value:function(e){this.setState({animations:e})}},{key:"toggleAnimation",value:function(e){var t=this.state.animations.map((function(t){return t.enabled=t.name===e,t}));this.refView3D.current.toggleAnimation(e),this.setState({animations:t})}},{key:"render",value:function(){return Object(k.jsxs)(i.a.Fragment,{children:[Object(k.jsx)(y,{toggleDrawer:this.toggleDrawer}),Object(k.jsx)(M,{ref:this.refDrawerMenu,save:this.save}),Object(k.jsx)(ce,{ref:this.refView3D,loadPath:"/3dprint-demo",object3D:"/objects/rhodesia-solider.glb",backgroundCube:["/textures/Brudslojan/posx.jpg","/textures/Brudslojan/negx.jpg","/textures/Brudslojan/posy.jpg","/textures/Brudslojan/negy.jpg","/textures/Brudslojan/posz.jpg","/textures/Brudslojan/negz.jpg"],animPoses:["/anims/fire_rifle.gltf","/anims/hit_reaction.gltf","/anims/reloading.gltf","/anims/rifle_aiming.gltf","/anims/rifle_jump.gltf","/anims/rifle_run.gltf","/anims/run_backwards.gltf","/anims/starfe_left.gltf","/anims/starfe_right.gltf","/anims/toss_grenade.gltf","/anims/turn_left.gltf","/anims/turn_right.gltf","/anims/walking_backwards.gltf","/anims/walking.gltf"],availableElements:this.availableElements,availableAnimations:this.availableAnimations}),Object(k.jsx)(te,{optElements:this.state.elements,toggleElement:this.toggleElement,optAnimations:this.state.animations,toggleAnimation:this.toggleAnimation})]})}}]),n}(a.Component),ue=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,193)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),i(e),r(e),o(e)}))};o.a.render(Object(k.jsx)(i.a.StrictMode,{children:Object(k.jsxs)(l.a,{theme:d,children:[Object(k.jsx)(s.a,{enableColorScheme:!0}),Object(k.jsx)(he,{})]})}),document.getElementById("root")),ue()}},[[136,1,2]]]);
//# sourceMappingURL=main.bb582ac7.chunk.js.map