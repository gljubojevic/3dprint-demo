(this["webpackJsonp3dprint-demo"]=this["webpackJsonp3dprint-demo"]||[]).push([[0],{109:function(e,t,n){},119:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(38),s=n.n(i),o=(n(109),n(168)),l=n(165),c=n(94),d=Object(c.a)({}),h=n(1),u=n(2),b=n(20),j=n(4),g=n(5),p=n(169),v=n(170),m=n(172),O=n(171),f=n(88),w=n.n(f),x=n(6),k=function(e){Object(j.a)(n,e);var t=Object(g.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(x.jsx)(p.a,{position:"fixed",children:Object(x.jsxs)(v.a,{variant:"regular",children:[Object(x.jsx)(O.a,{edge:"start",color:"inherit","aria-label":"menu",onClick:this.props.toggleDrawer,children:Object(x.jsx)(w.a,{})}),Object(x.jsx)(m.a,{variant:"h6",color:"inherit",children:"3D Print demo"})]})})}}]),n}(a.Component);k.defaultProps={toggleDrawer:null};var y=k,E=n(175),D=n(161),S=n(174),C=n(176),L=n(164),B=n(159),P=n(177),T=n(178),R=n(77),z=n.n(R),F=n(167),M=n(166),J=n(179),W=n(173),V=n(163),A=function(e){Object(j.a)(n,e);var t=Object(g.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).toggleDrawer=a.toggleDrawer.bind(Object(b.a)(a)),a.toggleElement=a.toggleElement.bind(Object(b.a)(a)),a.save=a.save.bind(Object(b.a)(a)),a.state={isOpen:!1},a}return Object(u.a)(n,[{key:"toggleDrawer",value:function(e){("keydown"!==e.type||"Tab"!==e.key&&"Shift"!==e.key)&&this.setState({isOpen:!this.state.isOpen})}},{key:"save",value:function(e){if(null!==this.props.save){var t=e.currentTarget.dataset.value;t||(t="STL"),this.setState({isOpen:!1}),this.props.save(t)}else console.error("No save handler set")}},{key:"toggleElement",value:function(e){this.props.toggleElement({name:e.target.name,visible:e.target.checked})}},{key:"renderSwitches",value:function(){var e=this;return this.props.availableElements.map((function(t,n){return Object(x.jsx)(W.a,{label:t.name,control:Object(x.jsx)(V.a,{checked:t.visible,onChange:e.toggleElement,name:t.name})},n)}))}},{key:"render",value:function(){return Object(x.jsx)(D.a,{anchor:"left",open:this.state.isOpen,onClose:this.toggleDrawer,children:Object(x.jsxs)(S.a,{p:1,children:[Object(x.jsx)(m.a,{variant:"h4",component:"h4",children:"Main menu"}),Object(x.jsx)(E.a,{}),Object(x.jsxs)(C.a,{component:"nav","aria-label":"main selector",children:[Object(x.jsx)(L.a,{children:Object(x.jsxs)(B.a,{onClick:this.save,"data-value":"STL",children:[Object(x.jsx)(P.a,{children:Object(x.jsx)(z.a,{})}),Object(x.jsx)(T.a,{primary:"Save STL for print"})]})}),Object(x.jsx)(L.a,{children:Object(x.jsxs)(B.a,{onClick:this.save,"data-value":"OBJ",children:[Object(x.jsx)(P.a,{children:Object(x.jsx)(z.a,{})}),Object(x.jsx)(T.a,{primary:"Save OBJ for print"})]})})]}),Object(x.jsx)(E.a,{}),Object(x.jsxs)(M.a,{component:"fieldset",variant:"standard",children:[Object(x.jsx)(F.a,{component:"legend",children:"Elements on/off"}),Object(x.jsx)(J.a,{children:this.renderSwitches()})]})]})})}}]),n}(a.Component);A.defaultProps={save:null,availableElements:[],toggleElement:null};var I=A,H=n(3),U=n(90),q=n(91),K=n(92),N=n(93),G=function(e){Object(j.a)(n,e);var t=Object(g.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).refRenderer=r.a.createRef(),a.save=a.save.bind(Object(b.a)(a)),a.animate=a.animate.bind(Object(b.a)(a)),a.loaderOk=a.loaderOk.bind(Object(b.a)(a)),a.loaderError=a.loaderError.bind(Object(b.a)(a)),a.loaderProgress=a.loaderProgress.bind(Object(b.a)(a)),a.toggleElement=a.toggleElement.bind(Object(b.a)(a)),a.onWindowResize=a.onWindowResize.bind(Object(b.a)(a)),a.exporterSTL=new K.a,a.exporterOBJ=new N.a,a.scene=new H.eb,a.dirLight1=new H.j(16777215),a.dirLight1.position.set(1,1,1),a.scene.add(a.dirLight1),a.dirLight2=new H.j(16777215),a.dirLight2.position.set(-1,-1,-1),a.scene.add(a.dirLight2),a.ambientLight=new H.a(2236962),a.scene.add(a.ambientLight),a.loader=new U.a,a}return Object(u.a)(n,[{key:"render",value:function(){return Object(x.jsx)(S.a,{ref:this.refRenderer,sx:{paddingTop:function(e){return e.mixins.toolbar.minHeight+"px"}}})}},{key:"save",value:function(e){console.log("Saving object");var t=this.scene.clone(),n=[];switch(t.traverse((function(e){e.visible||(console.log("To remove",e.name,e.id,e.uuid),n.push(e.id))})),n.forEach((function(e){var n=t.getObjectById(e);n.parent.remove(n)})),e){case"STL":return this.exporterSTL.parse(t,{binary:!0});case"OBJ":return this.exporterOBJ.parse(t)}return this.exporterSTL.parse(t,{binary:!0})}},{key:"componentDidMount",value:function(){var e=this.rendererDimensions();if(this.camera=new H.V(75,e.width/e.height,.1,100),this.camera.position.y=.2,this.camera.position.z=.1,this.renderer=new H.tb,this.renderer.setSize(e.width,e.height),this.refRenderer.current.appendChild(this.renderer.domElement),window.addEventListener("resize",this.onWindowResize),this.controls=new q.a(this.camera,this.renderer.domElement),this.controls.listenToKeyEvents(window),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.screenSpacePanning=!1,this.controls.minDistance=.22,this.controls.maxDistance=2,this.controls.maxPolarAngle=Math.PI/2,this.controls.target=new H.rb(0,.15,0),this.controls.update(),this.animate(),null!==this.props.loadPath){this.scene.background=this.loadBackgroundCube(this.props.backgroundCube);var t=this.loadBackgroundCube(this.props.backgroundCube);this.cubeMaterial1=new H.L({color:16777215,envMap:t}),this.loadObject(this.props.object3D)}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onWindowResize)}},{key:"rendererDimensions",value:function(){var e={width:window.innerWidth,height:window.innerHeight},t=getComputedStyle(this.refRenderer.current);return e.width-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),e.height-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),e}},{key:"onWindowResize",value:function(){var e=this.rendererDimensions();this.camera.aspect=e.width/e.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(e.width,e.height)}},{key:"loadObject",value:function(e){null!==e&&this.loader.load(this.props.loadPath+e,this.loaderOk,void 0,this.loaderError)}},{key:"loadBackgroundCube",value:function(e){if(null!==e)return(new H.i).setPath(this.props.loadPath).load(e)}},{key:"animate",value:function(){requestAnimationFrame(this.animate),this.renderer.render(this.scene,this.camera)}},{key:"loaderOk",value:function(e){console.log("Object loaded");for(var t=[],n=0;n<e.scene.children.length;n++){var a=e.scene.children[n];a.name.includes("-main")||(a.visible=!1,t.push({name:a.name,visible:!1}))}this.loadedObject=e.scene,this.scene.add(this.loadedObject),null!==this.props.availableElements&&this.props.availableElements(t)}},{key:"loaderProgress",value:function(e){console.log(e.loaded/e.total*100+"% loaded")}},{key:"loaderError",value:function(e){console.error(e)}},{key:"toggleElement",value:function(e){console.log("Toggle visible",e);for(var t=this.loadedObject,n=0;n<t.children.length;n++)t.children[n].name===e.name&&(t.children[n].visible=e.visible)}}]),n}(a.Component);G.defaultProps={loadPath:null,object3D:null,backgroundCube:null,availableElements:null};var Q=G,X=n(78),Y=function(e){Object(j.a)(n,e);var t=Object(g.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).state={elements:[]},a.refDrawerMenu=r.a.createRef(),a.refView3D=r.a.createRef(),a.toggleDrawer=a.toggleDrawer.bind(Object(b.a)(a)),a.save=a.save.bind(Object(b.a)(a)),a.availableElements=a.availableElements.bind(Object(b.a)(a)),a.toggleElement=a.toggleElement.bind(Object(b.a)(a)),a}return Object(u.a)(n,[{key:"toggleDrawer",value:function(e){this.refDrawerMenu.current.toggleDrawer(e)}},{key:"save",value:function(e){var t=this.refView3D.current.save(e);switch(e){case"STL":var n=new Blob([t],{type:"application/octet-stream"});Object(X.saveAs)(n,"for-print.stl");break;case"OBJ":var a=new Blob([t],{type:"text/plain"});Object(X.saveAs)(a,"for-print.obj");break;default:console.log("Unsupported file format ->",e)}}},{key:"availableElements",value:function(e){console.log(e),this.setState({elements:e})}},{key:"toggleElement",value:function(e){var t=this.state.elements.map((function(t){return t.name===e.name&&(t.visible=e.visible),t}));this.setState({elements:t}),this.refView3D.current.toggleElement(e)}},{key:"render",value:function(){return Object(x.jsxs)(r.a.Fragment,{children:[Object(x.jsx)(y,{toggleDrawer:this.toggleDrawer}),Object(x.jsx)(I,{ref:this.refDrawerMenu,save:this.save,availableElements:this.state.elements,toggleElement:this.toggleElement}),Object(x.jsx)(Q,{ref:this.refView3D,loadPath:"/3dprint-demo",object3D:"/objects/solider-demo.glb",backgroundCube:["/textures/Brudslojan/posx.jpg","/textures/Brudslojan/negx.jpg","/textures/Brudslojan/posy.jpg","/textures/Brudslojan/negy.jpg","/textures/Brudslojan/posz.jpg","/textures/Brudslojan/negz.jpg"],availableElements:this.availableElements})]})}}]),n}(a.Component),Z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,181)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),i(e),s(e)}))};s.a.render(Object(x.jsx)(r.a.StrictMode,{children:Object(x.jsxs)(l.a,{theme:d,children:[Object(x.jsx)(o.a,{enableColorScheme:!0}),Object(x.jsx)(Y,{})]})}),document.getElementById("root")),Z()}},[[119,1,2]]]);
//# sourceMappingURL=main.a1ff239f.chunk.js.map